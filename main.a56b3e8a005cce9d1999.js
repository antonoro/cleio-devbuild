"use strict";(self.webpackChunkfront_cleio=self.webpackChunkfront_cleio||[]).push([[179],{48734:(e,t,a)=>{var l=a(89346),n=a(67294),r=a(20745);const s=()=>{const[e,t]=(0,n.useState)(!1);return[e,function(){t(!e)}]};var c=a(73935);const m=[{label:"M"},{label:"F"},{label:"Autre"}],i=e=>{switch(e){case"bpm":return"bpm";case"skintemp":return"T&deg;";case"spo2":return"SpO<sub>2</sub>";default:return""}},o=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,d=e=>{l.td_(".radioOption").classed("selected",!1),l.Ys(e.target).classed("selected",!0)},u=()=>{const e=l.Ys(".selected");return e.node()?"Autre"===e.node().innerText?"A":"M"===e.node().innerText||"F"===e.node().innerText?e.node().innerText:"N/A":null},E=(e,t)=>{let a;e?a=e.target:t&&(a=t);const n=a.value;let r,s=!1;if("name"===a.id||"firstName"===a.id)s=String(n).length>0,r=String(n);else if("age"===a.id){const e=parseInt(String(n));s=!isNaN(e),r=e}else"email"===a.id&&(s=o.test(n),r=n);return l.Ys(a).classed(s?"valid":"error",!0),e?s:t?[s,r,a.id]:void 0},p=e=>{l.Ys(e.target).classed("valid",!1),l.Ys(e.target).classed("error",!1)},v=()=>{const e=l.td_("input").nodes();let t=!0,a={};return e.map((e=>{let l=E(null,e);l[0]?a[`${l[2]}`]=l[1]:t=!1})),u()?a.sex=u():t=!1,a.curVitals={bpm:0,skintemp:0,spo2:0},[t,a]},N=e=>{let{isOpened:t,hide:a,action:l}=e;return t?c.createPortal(n.createElement(n.Fragment,null,n.createElement("div",{className:"modal-overlay"}),n.createElement("div",{className:"modal-wrapper","aria-modal":!0,"aria-hidden":!0,tabIndex:-1,role:"dialog"},n.createElement("div",{className:"modal"},n.createElement("div",{className:"modal-header"},n.createElement("h2",null,"Ajouter un patient")),n.createElement("form",null,n.createElement("div",{className:"form-group"},n.createElement("div",{className:"holder label"},n.createElement("label",null,"Nom")),n.createElement("div",{className:"holder input"},n.createElement("input",{className:"form-control",id:"name",onBlur:e=>{E(e,null)},onInput:p}))),n.createElement("div",{className:"form-group"},n.createElement("div",{className:"holder label"},n.createElement("label",null,"Prénom")),n.createElement("div",{className:"holder input"},n.createElement("input",{className:"form-control",id:"firstName",onBlur:e=>{E(e,null)},onInput:p}))),n.createElement("div",{className:"form-group"},n.createElement("div",{className:"holder label"},n.createElement("label",null,"Âge")),n.createElement("div",{className:"holder input"},n.createElement("input",{className:"form-control",id:"age",onBlur:e=>{E(e,null)},onInput:p}))),n.createElement("div",{className:"form-group"},n.createElement("div",{className:"holder label"},n.createElement("label",null,"Sexe")),n.createElement("div",{className:"holder input"},n.createElement("div",{className:"radioHolder"},m.map(((e,t)=>n.createElement("div",{key:`${e.label}`,className:"radioOption",onClick:d},n.createElement("p",null,e.label))))))),n.createElement("div",{className:"form-group"},n.createElement("div",{className:"holder label"},n.createElement("label",null,"Email")),n.createElement("div",{className:"holder input"},n.createElement("input",{className:"form-control",id:"email",onBlur:e=>{E(e,null)},onInput:p})))),n.createElement("div",{className:"btnArray"},n.createElement("div",{className:"btnHolder"},n.createElement("div",{className:"btn cancel",onClick:a},n.createElement("p",null,"Annuler"))),n.createElement("div",{className:"btnHolder"},n.createElement("div",{className:"btn accept",onClick:()=>{v()[0]&&(l(v()[1]),a())}},n.createElement("p",null,"Confirmer"))))))),document.body):null};var h=a(25935);const b=e=>{let{isOpened:t,hide:a,patient:l,vitals:r,action:s}=e;return t?c.createPortal(n.createElement(n.Fragment,null,n.createElement("div",{className:"modal-overlay"}),n.createElement("div",{className:"modal-wrapper","aria-modal":!0,"aria-hidden":!0,tabIndex:-1,role:"dialog"},n.createElement("div",{className:"modal"},n.createElement("div",{className:"x-holder"},n.createElement("img",{onClick:a,src:"assets/img/x.png"})),n.createElement("div",{className:"modal-header"},n.createElement("h2",null,"Visualiser un patient")),l?n.createElement("div",{className:"modal-body"},n.createElement("div",{className:"modal-unit inline"},n.createElement("p",null,l.firstName," "),n.createElement("p",null,n.createElement("b",null,l.name))),n.createElement("div",{className:"modal-unit inline"},n.createElement("p",null,l.age," ans • "),n.createElement("p",null,(e=>{switch(e){case"F":return"Femme";case"M":return"Homme";case"A":return"Autre";default:return"N/A"}})(l.sex))),n.createElement("div",{className:"modal-unit inline"},n.createElement("p",null,l.email))):null,n.createElement("div",{className:"table-holder"},l&&r?n.createElement("table",{className:"vitals-table",cellSpacing:"0"},n.createElement("thead",{className:"vitalheaderrow"},n.createElement("tr",null,n.createElement("th",null),r.headers.map(((e,t)=>n.createElement("th",{key:t},(0,h.ZP)(i(e)))))),n.createElement("tr",null,n.createElement("td",null,n.createElement("h3",null,"Statistiques")),r.headers.map(((e,t)=>n.createElement("td",{key:t}," ")))),((e,t)=>{let a={};return t.map(((e,t)=>{a[e]=0})),e.slice(0,30).forEach(((e,t)=>{Object.entries(e[1]).forEach(((e,t)=>{const l=e[0],n=e[1];a[l]=parseFloat(a[l]+n)}))})),Object.keys(a).forEach((e=>{a[e]="bpm"===e?parseInt(a[e]/30):"skintemp"===e?parseFloat(parseFloat(a[e]/30).toFixed(2)):parseFloat(parseFloat(a[e]/30).toFixed(3))})),n.createElement("tr",{className:"vitalrow"},n.createElement("td",null,"Moyenne des 5 dernières minutes"),Object.values(a).map(((e,t)=>n.createElement("td",{key:t},e))))})(Object.entries(r.measurements).reverse(),r.headers),n.createElement("tr",null,n.createElement("td",null,n.createElement("h3",null,"Données")),r.headers.map(((e,t)=>n.createElement("td",{key:t}," "))))),n.createElement("tbody",{className:"data-holder"},Object.entries(r.measurements).reverse().map(((e,t)=>n.createElement("tr",{className:"vitalrow",key:t},n.createElement("td",null,e[0]),Object.entries(e[1]).map(((e,t)=>n.createElement("td",{key:t},e[1])))))))):null)))),document.body):null};function f(e){const t={name:e.patientData.name,firstName:e.patientData.firstName,age:e.patientData.age,sex:e.patientData.sex,contact:e.patientData.email,patientID:e.patientData.patientID,vitals:e.patientData.curVitals};return n.createElement("div",{className:"patientEntry"},n.createElement("div",{className:"division names"},n.createElement("h4",null,t.name),n.createElement("p",null,t.firstName)),n.createElement("div",{className:"division age"},n.createElement("h5",null,t.age," ans")),n.createElement("div",{className:"division sex"},n.createElement("h5",null,t.sex)),n.createElement("div",{className:"division contact"},n.createElement("h5",null,n.createElement("a",{href:`mailto:${t.contact}`},"Contact"))),n.createElement("div",{className:"division vitals"},Object.entries(t.vitals).map(((e,t)=>n.createElement("div",{key:t,className:"vitalUnit"},n.createElement("p",{className:"type"},(0,h.ZP)(i(e[0]))),n.createElement("h5",{className:"value"},e[1]))))),n.createElement("div",{className:"division eye",onClick:()=>{e.showPatient(t.patientID)}},n.createElement("img",{src:"assets/img/eye.png"})),n.createElement("div",{className:"division delete",onClick:()=>{e.deletePatient(t.patientID)}},n.createElement("img",{src:"assets/img/bin.png"})))}const g="https://cleio-server.herokuapp.com/api";function y(e,t){return fetch(`${g}${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((e=>e.json())).then((e=>e)).catch((e=>(console.log("Error sending Get request: ",e),null)))}function k(e,t,a){const l={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)};return fetch(`${g}${e}`,l).then((e=>e.json())).then((e=>e)).catch((e=>(console.log("Error sending Post request:",e),null)))}function w(e){const[t,a]=(0,n.useState)(null),[l,r]=s(),[c,m]=s(),[i,o]=(0,n.useState)(null),[d,u]=(0,n.useState)(null);(0,n.useEffect)((()=>{E()}),[]),function(e,t){const a=(0,n.useRef)();(0,n.useEffect)((()=>{a.current=e}),[e]),(0,n.useEffect)((()=>{{let e=setInterval((function(){a.current()}),t);return()=>clearInterval(e)}}),[t])}((()=>{E(),i&&p(i.patientID)}),1e4),(0,n.useEffect)((()=>{}),[i]),(0,n.useEffect)((()=>{}),[d]);const E=()=>{y("/patients").then((e=>{a(e)}))},p=e=>{y(`/vitals/${e}`).then((e=>{e.results&&u(e.results)}))},v=e=>{k(`/patients/delete/${e}`,0,{}).then((e=>{E()}))},h=e=>{const t=parseInt(e);m(!0),y(`/patients/${t}`).then((e=>{e.results&&(o(e.results),p(t))}))};return n.createElement("div",{className:"mainframe"},n.createElement("div",{className:"header"},n.createElement("div",{className:"labelHolder"},n.createElement("h2",null,"Tableau de bord")),n.createElement("div",{className:"buttonHolder"},n.createElement("div",{className:"btn",onClick:r},n.createElement("p",null,"Ajouter")))),n.createElement("div",{className:"patientList"},t?t.map(((e,t)=>n.createElement(f,{key:t,patientData:e,deletePatient:v,showPatient:h}))):""),n.createElement("div",{className:"link-holder"},n.createElement("p",null,n.createElement("a",{href:"https://docs.google.com/presentation/d/1Yuvrv6VnN413m8KntJcfW60Uw5WQd7B5XJyjbiaDK_Y/edit?usp=sharing"},"Link to presentation"))),n.createElement(N,{isOpened:l,hide:r,action:e=>{k("/patients/new",0,e).then((e=>{E()}))}}),n.createElement(b,{isOpened:c,hide:()=>{m(),o(null),u(null)},patient:i,vitals:d,action:()=>{console.log("not implemented.")}}))}r.createRoot(document.getElementById("root")).render(n.createElement(w,null))}},e=>{var t=t=>e(e.s=t);e.O(0,[216],(()=>(t(28594),t(35666),t(48734)))),e.O()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUEsY0FBQSxPQUFLQyxVQUFVLE1BQU1RLFFBQVNvRSxHQUMxQjdFLEVBQUFBLGNBQUEsU0FBRyxjQUlmQSxFQUFBQSxjQUFBLE9BQUtDLFVBQVUsZUFFUHlFLEVBQ0lBLEVBQWVuRixLQUFJLENBQUN3QyxFQUFLeEIsSUFDZFAsRUFBQUEsY0FBQzhDLEVBQVksQ0FBQ3RDLElBQUtELEVBQ04wQyxZQUFhbEIsRUFDYndCLGNBQWVBLEVBQ2ZELFlBQWFBLE1BR3JDLElBR1p0RCxFQUFBQSxjQUFBLE9BQUtDLFVBQVUsZUFDWEQsRUFBQUEsY0FBQSxTQUFHQSxFQUFBQSxjQUFBLEtBQUdxRCxLQUFLLHdHQUF1RywwQkFFdEhyRCxFQUFBQSxjQUFDa0csRUFBZSxDQUNaNUksU0FBVXNILEVBQ1YvRSxLQUFNZ0YsRUFDTi9FLE9BMURRcUcsSUFDaEI5QixFTGhEZSxnQktnRDJCLEVBQU04QixHQUMvQ3JDLE1BQUtpQyxJQUNGVixHQUFtQixHQUNyQixJQXdERXJGLEVBQUFBLGNBQUNvRyxFQUFnQixDQUNiOUksU0FBVXdILEVBQ1ZqRixLQUFNQSxLQUNGa0YsSUFDQUUsRUFBa0IsTUFDbEJFLEVBQXFCLEtBQUssRUFHOUJ2RSxRQUFTb0UsRUFDVG5FLE9BQVFxRSxFQUNScEYsT0FBUUEsS0FBT3FFLFFBQVFDLElBQUksbUJBQW1CLElBSzlELENFdEhhckUsRUFBQUEsV0FBb0JXLFNBQVMyRixlQUFlLFNBQ3BEQyxPQUNEdEcsRUFBQUEsY0FBQ3lFLEVBQVMsTSIsInNvdXJjZXMiOlsid2VicGFjazovL2Zyb250LWNsZWlvLy4vc3JjL2FwcC9jb21wb25lbnRzL3VzZU1vZGFsLmpzIiwid2VicGFjazovL2Zyb250LWNsZWlvLy4vc3JjL2FwcC91dGlsaXRpZXMuanMiLCJ3ZWJwYWNrOi8vZnJvbnQtY2xlaW8vLi9zcmMvYXBwL2NvbXBvbmVudHMvTW9kYWxBZGRQYXRpZW50LmpzIiwid2VicGFjazovL2Zyb250LWNsZWlvLy4vc3JjL2FwcC9jb21wb25lbnRzL01vZGFsVmlld1BhdGllbnQuanMiLCJ3ZWJwYWNrOi8vZnJvbnQtY2xlaW8vLi9zcmMvYXBwL2NvbXBvbmVudHMvUGF0aWVudEVudHJ5LmpzIiwid2VicGFjazovL2Zyb250LWNsZWlvLy4vc3JjL2FwcC9yZXF1ZXN0ZXIuanMiLCJ3ZWJwYWNrOi8vZnJvbnQtY2xlaW8vLi9zcmMvYXBwL2NvbXBvbmVudHMvRGFzaGJvYXJkLmpzIiwid2VicGFjazovL2Zyb250LWNsZWlvLy4vc3JjL2FwcC9jb21wb25lbnRzL3VzZUludGVydmFsLmpzIiwid2VicGFjazovL2Zyb250LWNsZWlvLy4vc3JjL2FwcC9hcHAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XHJcblxyXG5jb25zdCB1c2VNb2RhbCA9ICgpID0+IHtcclxuICBjb25zdCBbaXNPcGVuZWQsIHNldE9wZW5lZF0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcblxyXG4gIGZ1bmN0aW9uIHRvZ2dsZSgpIHtcclxuICAgIHNldE9wZW5lZCghaXNPcGVuZWQpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIFtcclxuICAgIGlzT3BlbmVkLFxyXG4gICAgdG9nZ2xlXHJcbiAgXVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgdXNlTW9kYWw7IiwiZXhwb3J0IGNvbnN0IHJvdXRlcyA9IHtcclxuICAgIGdldEFsbFBhdGllbnRzOiBcIi9wYXRpZW50c1wiLFxyXG4gICAgZ2V0U2luZ2xlUGF0aWVudDogXCIvcGF0aWVudHMvXCIsXHJcbiAgICBnZXRWaXRhbHNmb3JQYXRpZW50OiBcIi92aXRhbHMvXCIsXHJcbiAgICBwb3N0U2luZ2xlUGF0aWVudDogXCIvcGF0aWVudHMvbmV3XCIsXHJcbiAgICBkZWxldGVTaW5nbGVQYXRpZW50OiBcIi9wYXRpZW50cy9kZWxldGUvXCJcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZXhPcHRpb25zID0gW1xyXG4gICAge1xyXG4gICAgICAgIGxhYmVsOlwiTVwiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIGxhYmVsOlwiRlwiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIGxhYmVsOlwiQXV0cmVcIlxyXG4gICAgfVxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1hdEhlYWRlcnMgPSAodmFsdWUpID0+IHtcclxuICAgIHN3aXRjaCh2YWx1ZSl7XHJcbiAgICAgICAgY2FzZSBcImJwbVwiOlxyXG4gICAgICAgICAgICByZXR1cm4gXCJicG1cIjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgY2FzZSBcInNraW50ZW1wXCI6XHJcbiAgICAgICAgICAgIHJldHVybiBgVCR7JyZkZWc7J31gO1xyXG5cclxuICAgICAgICBjYXNlIFwic3BvMlwiOlxyXG4gICAgICAgICAgICByZXR1cm4gYFNwTzxzdWI+Mjwvc3ViPmA7XHJcblxyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgfVxyXG4gICAgXHJcbn0iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBSZWFjdERPTSBmcm9tIFwicmVhY3QtZG9tXCI7XHJcbmltcG9ydCB7IHNleE9wdGlvbnMgfSBmcm9tIFwiLi4vdXRpbGl0aWVzXCI7XHJcbmltcG9ydCAqIGFzIGQzIGZyb20gJ2QzJztcclxuXHJcbmNvbnN0IGVtYWlsUmVnZXggPSAvXlxcdysoW1xcLi1dP1xcdyspKkBcXHcrKFtcXC4tXT9cXHcrKSooXFwuXFx3ezIsM30pKyQvO1xyXG5cclxuY29uc3Qgb25TZWxlY3RTZXggPSAoZSkgPT4ge1xyXG4gICAgZDMuc2VsZWN0QWxsKCcucmFkaW9PcHRpb24nKS5jbGFzc2VkKCdzZWxlY3RlZCcsIGZhbHNlKTtcclxuICAgIGQzLnNlbGVjdChlLnRhcmdldCkuY2xhc3NlZCgnc2VsZWN0ZWQnLCB0cnVlKTtcclxufVxyXG5cclxuY29uc3QgZ2V0U2VsZWN0ZWRTZXggPSAoKSA9PiB7XHJcbiAgICBjb25zdCBzZWxlY3RlZEJ0bj0gZDMuc2VsZWN0KCcuc2VsZWN0ZWQnKTtcclxuICAgIGlmKHNlbGVjdGVkQnRuLm5vZGUoKSl7XHJcbiAgICAgICAgaWYoc2VsZWN0ZWRCdG4ubm9kZSgpLmlubmVyVGV4dCA9PT0gXCJBdXRyZVwiKXtcclxuICAgICAgICAgICAgcmV0dXJuIFwiQVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHNlbGVjdGVkQnRuLm5vZGUoKS5pbm5lclRleHQgPT09IFwiTVwiIHx8XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZEJ0bi5ub2RlKCkuaW5uZXJUZXh0ID09PSBcIkZcIil7XHJcbiAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZEJ0bi5ub2RlKCkuaW5uZXJUZXh0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICByZXR1cm4gXCJOL0FcIjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNle1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCB2ZXJpZnlJbnB1dCA9IChlLCB0YXJnZXQpID0+IHtcclxuICAgIGxldCBjdXJUYXJnZXQ7XHJcbiAgICBpZihlKXtcclxuICAgICAgICBjdXJUYXJnZXQgPSBlLnRhcmdldDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYodGFyZ2V0KXtcclxuICAgICAgICBjdXJUYXJnZXQgPSB0YXJnZXQ7XHJcbiAgICB9XHJcbiAgICBjb25zdCBjdXJWYWx1ZSA9IGN1clRhcmdldC52YWx1ZTtcclxuICAgIGxldCB2ZXJpZmllZFN0YXRlID0gZmFsc2U7XHJcbiAgICBsZXQgdmFsdWU7XHJcbiAgICBpZihjdXJUYXJnZXQuaWQgPT09IFwibmFtZVwiIHx8IGN1clRhcmdldC5pZCA9PT0gXCJmaXJzdE5hbWVcIil7XHJcbiAgICAgICAgdmVyaWZpZWRTdGF0ZSA9IFN0cmluZyhjdXJWYWx1ZSkubGVuZ3RoID4gMDtcclxuICAgICAgICB2YWx1ZSA9IFN0cmluZyhjdXJWYWx1ZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKGN1clRhcmdldC5pZCA9PT0gXCJhZ2VcIil7XHJcbiAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQoU3RyaW5nKGN1clZhbHVlKSk7XHJcbiAgICAgICAgdmVyaWZpZWRTdGF0ZSA9ICFpc05hTihudW0pO1xyXG4gICAgICAgIHZhbHVlID0gbnVtO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZihjdXJUYXJnZXQuaWQgPT09IFwiZW1haWxcIil7XHJcbiAgICAgICAgdmVyaWZpZWRTdGF0ZSA9IGVtYWlsUmVnZXgudGVzdChjdXJWYWx1ZSk7XHJcbiAgICAgICAgdmFsdWUgPSBjdXJWYWx1ZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZDMuc2VsZWN0KGN1clRhcmdldCkuY2xhc3NlZChgJHt2ZXJpZmllZFN0YXRlID8gXCJ2YWxpZFwiOlwiZXJyb3JcIn1gLCB0cnVlKTtcclxuICAgIFxyXG4gICAgaWYoZSl7XHJcbiAgICAgICAgcmV0dXJuIHZlcmlmaWVkU3RhdGU7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKHRhcmdldCl7XHJcbiAgICAgICAgcmV0dXJuIFt2ZXJpZmllZFN0YXRlLCB2YWx1ZSwgY3VyVGFyZ2V0LmlkXTtcclxuICAgIH1cclxufVxyXG5cclxuY29uc3QgcmVzZXRJbnB1dERlY29yYXRpb24gPSAoZSkgPT4ge1xyXG4gICAgZDMuc2VsZWN0KGUudGFyZ2V0KS5jbGFzc2VkKCd2YWxpZCcsIGZhbHNlKTtcclxuICAgIGQzLnNlbGVjdChlLnRhcmdldCkuY2xhc3NlZCgnZXJyb3InLCBmYWxzZSk7XHJcbn1cclxuXHJcbmNvbnN0IHZlcmlmeUFsbElucHV0cyA9ICgpID0+IHtcclxuICAgIFxyXG4gICAgY29uc3Qgc2VsZWN0aW9uID0gZDMuc2VsZWN0QWxsKCdpbnB1dCcpLm5vZGVzKCk7XHJcbiAgICBsZXQgdmVyaWZpZWRTdGF0ZSA9IHRydWU7XHJcbiAgICBsZXQgdmVyaWZpZWRPYmogPSB7fTtcclxuICAgIHNlbGVjdGlvbi5tYXAobm9kZSA9PiB7XHJcbiAgICAgICAgbGV0IGN1ckNoZWNrZWRJbnB1dCA9IHZlcmlmeUlucHV0KG51bGwsIG5vZGUpO1xyXG4gICAgICAgIGlmKCFjdXJDaGVja2VkSW5wdXRbMF0pe1xyXG4gICAgICAgICAgICB2ZXJpZmllZFN0YXRlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHZlcmlmaWVkT2JqW2Ake2N1ckNoZWNrZWRJbnB1dFsyXX1gXSA9IGN1ckNoZWNrZWRJbnB1dFsxXTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIGlmKCFnZXRTZWxlY3RlZFNleCgpKXtcclxuICAgICAgICB2ZXJpZmllZFN0YXRlID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBlbHNle1xyXG4gICAgICAgIHZlcmlmaWVkT2JqW1wic2V4XCJdID0gZ2V0U2VsZWN0ZWRTZXgoKTtcclxuICAgIH1cclxuXHJcbiAgICB2ZXJpZmllZE9ialtcImN1clZpdGFsc1wiXSA9IHtcclxuICAgICAgICBicG06IDAsXHJcbiAgICAgICAgc2tpbnRlbXA6IDAsXHJcbiAgICAgICAgc3BvMjogMFxyXG4gICAgfTtcclxuICAgIHJldHVybiBbdmVyaWZpZWRTdGF0ZSwgdmVyaWZpZWRPYmpdO1xyXG59XHJcblxyXG5jb25zdCBNb2RhbEFkZFBhdGllbnQgPSAoeyBpc09wZW5lZCwgaGlkZSwgYWN0aW9uIH0pID0+IGlzT3BlbmVkID8gUmVhY3RET00uY3JlYXRlUG9ydGFsKFxyXG4gICAgXHJcbiAgICA8UmVhY3QuRnJhZ21lbnQ+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbC1vdmVybGF5XCIvPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtd3JhcHBlclwiIGFyaWEtbW9kYWwgYXJpYS1oaWRkZW4gdGFiSW5kZXg9ey0xfSByb2xlPVwiZGlhbG9nXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWxcIj5cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbC1oZWFkZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICA8aDI+QWpvdXRlciB1biBwYXRpZW50PC9oMj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGZvcm0+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmb3JtLWdyb3VwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9sZGVyIGxhYmVsXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+Tm9tPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9sZGVyIGlucHV0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3NOYW1lPVwiZm9ybS1jb250cm9sXCIgaWQ9XCJuYW1lXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkJsdXI9eyhlKSA9PiB7dmVyaWZ5SW5wdXQoZSxudWxsKX19IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uSW5wdXQ9e3Jlc2V0SW5wdXREZWNvcmF0aW9ufVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmb3JtLWdyb3VwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9sZGVyIGxhYmVsXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+UHLDqW5vbTwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvbGRlciBpbnB1dFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzTmFtZT1cImZvcm0tY29udHJvbFwiIGlkPVwiZmlyc3ROYW1lXCIgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25CbHVyPXsoZSkgPT4ge3ZlcmlmeUlucHV0KGUsbnVsbCl9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uSW5wdXQ9e3Jlc2V0SW5wdXREZWNvcmF0aW9ufS8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9ybS1ncm91cFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvbGRlciBsYWJlbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPsOCZ2U8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob2xkZXIgaW5wdXRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzc05hbWU9XCJmb3JtLWNvbnRyb2xcIiBpZD1cImFnZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25CbHVyPXsoZSkgPT4ge3ZlcmlmeUlucHV0KGUsbnVsbCl9fSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbklucHV0PXtyZXNldElucHV0RGVjb3JhdGlvbn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9ybS1ncm91cFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvbGRlciBsYWJlbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlNleGU8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob2xkZXIgaW5wdXRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmFkaW9Ib2xkZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V4T3B0aW9ucy5tYXAoKG9wdGlvbiwgY291bnQpID0+IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGtleT17YCR7b3B0aW9uLmxhYmVsfWB9IGNsYXNzTmFtZT1cInJhZGlvT3B0aW9uXCIgb25DbGljaz17b25TZWxlY3RTZXh9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPntvcHRpb24ubGFiZWx9PC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9ybS1ncm91cFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvbGRlciBsYWJlbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPkVtYWlsPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9sZGVyIGlucHV0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3NOYW1lPVwiZm9ybS1jb250cm9sXCIgaWQ9XCJlbWFpbFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25CbHVyPXsoZSkgPT4ge3ZlcmlmeUlucHV0KGUsbnVsbCl9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uSW5wdXQ9e3Jlc2V0SW5wdXREZWNvcmF0aW9ufVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Zvcm0+XHJcblxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG5BcnJheVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuSG9sZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuIGNhbmNlbFwiIG9uQ2xpY2s9e2hpZGV9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+QW5udWxlcjwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG5Ib2xkZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4gYWNjZXB0XCIgb25DbGljaz17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodmVyaWZ5QWxsSW5wdXRzKClbMF0pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24odmVyaWZ5QWxsSW5wdXRzKClbMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPkNvbmZpcm1lcjwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICA8L1JlYWN0LkZyYWdtZW50PiwgZG9jdW1lbnQuYm9keVxyXG5cclxuKVxyXG46XHJcbm51bGw7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBNb2RhbEFkZFBhdGllbnQ7XHJcblxyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBSZWFjdERPTSBmcm9tIFwicmVhY3QtZG9tXCI7XHJcbmltcG9ydCBwYXJzZSBmcm9tICdodG1sLXJlYWN0LXBhcnNlcic7XHJcbmltcG9ydCB7IGZvcm1hdEhlYWRlcnMgfSBmcm9tIFwiLi4vdXRpbGl0aWVzXCI7XHJcblxyXG5jb25zdCBmb3JtYXRTZXggPSAoc2V4KSA9PiB7XHJcbiAgICBzd2l0Y2goc2V4KXtcclxuICAgICAgICBjYXNlIFwiRlwiOlxyXG4gICAgICAgICAgICByZXR1cm4gXCJGZW1tZVwiO1xyXG4gICAgICAgIGNhc2UgXCJNXCI6XHJcbiAgICAgICAgICAgIHJldHVybiBcIkhvbW1lXCI7XHJcbiAgICAgICAgY2FzZSBcIkFcIjpcclxuICAgICAgICAgICAgcmV0dXJuIFwiQXV0cmVcIjtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gXCJOL0FcIjtcclxuICAgIH1cclxufVxyXG5cclxuY29uc3QgY2FsY3VsYXRlU3RhdHMgPSAoZGF0YSwgdml0YWxIZWFkZXJzKSA9PiB7XHJcbiAgICBcclxuICAgIGxldCBzdW1tZWREYXRhID0ge307XHJcblxyXG4gICAgdml0YWxIZWFkZXJzLm1hcCgodml0YWxIZWFkZXIsIGNvdW50KSA9PiB7XHJcbiAgICAgICAgc3VtbWVkRGF0YVt2aXRhbEhlYWRlcl0gPSAwO1xyXG4gICAgfSk7XHJcbiAgICBkYXRhLnNsaWNlKDAsIDMwKS5mb3JFYWNoKChlbGVtLGkpID0+IHtcclxuICAgICAgICBPYmplY3QuZW50cmllcyhlbGVtWzFdKS5mb3JFYWNoKChtZWFzdXJlbWVudFZhbHVlLCBpZHgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VyTWVhc3VyZW1lbnRUeXBlID0gbWVhc3VyZW1lbnRWYWx1ZVswXTtcclxuICAgICAgICAgICAgY29uc3QgY3VyTWVhc3VyZW1lbnRWYWx1ZSA9IG1lYXN1cmVtZW50VmFsdWVbMV07XHJcbiAgICAgICAgICAgIHN1bW1lZERhdGFbY3VyTWVhc3VyZW1lbnRUeXBlXSA9IHBhcnNlRmxvYXQoc3VtbWVkRGF0YVtjdXJNZWFzdXJlbWVudFR5cGVdICsgY3VyTWVhc3VyZW1lbnRWYWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KVxyXG4gICAgT2JqZWN0LmtleXMoc3VtbWVkRGF0YSkuZm9yRWFjaCgoY3VyTWVhc3VyZW1lbnRUeXBlKSA9PiB7XHJcbiAgICAgICAgaWYoY3VyTWVhc3VyZW1lbnRUeXBlID09PSBcImJwbVwiKXtcclxuICAgICAgICAgICAgc3VtbWVkRGF0YVtjdXJNZWFzdXJlbWVudFR5cGVdID0gcGFyc2VJbnQoc3VtbWVkRGF0YVtjdXJNZWFzdXJlbWVudFR5cGVdIC8gMzApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKGN1ck1lYXN1cmVtZW50VHlwZSA9PT0gXCJza2ludGVtcFwiKXtcclxuICAgICAgICAgICAgc3VtbWVkRGF0YVtjdXJNZWFzdXJlbWVudFR5cGVdID0gcGFyc2VGbG9hdChwYXJzZUZsb2F0KHN1bW1lZERhdGFbY3VyTWVhc3VyZW1lbnRUeXBlXSAvIDMwKS50b0ZpeGVkKDIpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgc3VtbWVkRGF0YVtjdXJNZWFzdXJlbWVudFR5cGVdID0gcGFyc2VGbG9hdChwYXJzZUZsb2F0KHN1bW1lZERhdGFbY3VyTWVhc3VyZW1lbnRUeXBlXSAvIDMwKS50b0ZpeGVkKDMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiAoXHJcbiAgICAgICAgPHRyIGNsYXNzTmFtZT1cInZpdGFscm93XCI+XHJcbiAgICAgICAgICAgIDx0ZD5Nb3llbm5lIGRlcyA1IGRlcm5pw6hyZXMgbWludXRlczwvdGQ+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIE9iamVjdC52YWx1ZXMoc3VtbWVkRGF0YSkubWFwKCh2YWx1ZSxpZHgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8dGQga2V5PXtpZHh9Pnt2YWx1ZX08L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICA8L3RyPlxyXG4gICAgKVxyXG59XHJcblxyXG5jb25zdCBNb2RhbFZpZXdQYXRpZW50ID0gKHsgaXNPcGVuZWQsIGhpZGUsIHBhdGllbnQsIHZpdGFscywgYWN0aW9uIH0pID0+IGlzT3BlbmVkID8gUmVhY3RET00uY3JlYXRlUG9ydGFsKFxyXG5cclxuICAgIDxSZWFjdC5GcmFnbWVudD5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLW92ZXJsYXlcIi8+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbC13cmFwcGVyXCIgYXJpYS1tb2RhbCBhcmlhLWhpZGRlbiB0YWJJbmRleD17LTF9IHJvbGU9XCJkaWFsb2dcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbFwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ4LWhvbGRlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxpbWcgb25DbGljaz17aGlkZX0gXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYz1cImFzc2V0cy9pbWcveC5wbmdcIlxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtaGVhZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGgyPlZpc3VhbGlzZXIgdW4gcGF0aWVudDwvaDI+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHBhdGllbnQgPyBcclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLWJvZHlcIj4gICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLXVuaXQgaW5saW5lXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD57cGF0aWVudC5maXJzdE5hbWV9Jm5ic3A7PC9wPjxwPjxiPntwYXRpZW50Lm5hbWV9PC9iPjwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtdW5pdCBpbmxpbmVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPntwYXRpZW50LmFnZX0gYW5zJm5ic3A7JiM4MjI2OyZuYnNwOzwvcD48cD57Zm9ybWF0U2V4KHBhdGllbnQuc2V4KX08L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLXVuaXQgaW5saW5lXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD57cGF0aWVudC5lbWFpbH08L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDogXHJcbiAgICAgICAgICAgICAgICAgICAgbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YWJsZS1ob2xkZXJcIj4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aWVudCAmJiB2aXRhbHM/XHJcbiAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzTmFtZT1cInZpdGFscy10YWJsZVwiIGNlbGxTcGFjaW5nPVwiMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQgY2xhc3NOYW1lPVwidml0YWxoZWFkZXJyb3dcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+PC90aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpdGFscy5oZWFkZXJzLm1hcCgodml0YWxIZWFkZXIsIGNvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBrZXk9e2NvdW50fT57cGFyc2UoZm9ybWF0SGVhZGVycyh2aXRhbEhlYWRlcikpfTwvdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+PGgzPlN0YXRpc3RpcXVlczwvaDM+PC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpdGFscy5oZWFkZXJzLm1hcCgodml0YWxIZWFkZXIsIGNvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBrZXk9e2NvdW50fT4mbmJzcDs8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlU3RhdHMoT2JqZWN0LmVudHJpZXModml0YWxzLm1lYXN1cmVtZW50cykucmV2ZXJzZSgpLCB2aXRhbHMuaGVhZGVycylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+PGgzPkRvbm7DqWVzPC9oMz48L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdml0YWxzLmhlYWRlcnMubWFwKCh2aXRhbEhlYWRlciwgY291bnQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGtleT17Y291bnR9PiZuYnNwOzwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC90aGVhZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5IGNsYXNzTmFtZT1cImRhdGEtaG9sZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZW50cmllcyh2aXRhbHMubWVhc3VyZW1lbnRzKS5yZXZlcnNlKCkubWFwKChtZWFzdXJlbWVudCxjb3VudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzTmFtZT1cInZpdGFscm93XCIga2V5PXtjb3VudH0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPnttZWFzdXJlbWVudFswXX08L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMobWVhc3VyZW1lbnRbMV0pLm1hcCgobWVhc3VyZW1lbnRWYWx1ZSwgaWR4KSA9PntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQga2V5PXtpZHh9PnttZWFzdXJlbWVudFZhbHVlWzFdfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cclxuICAgICAgICAgICAgICAgICAgICA6XHJcbiAgICAgICAgICAgICAgICAgICAgbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgPC9SZWFjdC5GcmFnbWVudD4sIGRvY3VtZW50LmJvZHlcclxuKVxyXG46XHJcbm51bGw7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBNb2RhbFZpZXdQYXRpZW50OyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBwYXJzZSBmcm9tIFwiaHRtbC1yZWFjdC1wYXJzZXJcIjtcclxuaW1wb3J0IHsgZm9ybWF0SGVhZGVycyB9IGZyb20gJy4uL3V0aWxpdGllcyc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gUGF0aWVudEVudHJ5IChwcm9wcykge1xyXG5cclxuICAgIGNvbnN0IHBhdGllbnRJbmZvID0ge1xyXG4gICAgICAgIG5hbWU6IHByb3BzLnBhdGllbnREYXRhLm5hbWUsXHJcbiAgICAgICAgZmlyc3ROYW1lOiBwcm9wcy5wYXRpZW50RGF0YS5maXJzdE5hbWUsXHJcbiAgICAgICAgYWdlOiBwcm9wcy5wYXRpZW50RGF0YS5hZ2UsXHJcbiAgICAgICAgc2V4OiBwcm9wcy5wYXRpZW50RGF0YS5zZXgsXHJcbiAgICAgICAgY29udGFjdDogcHJvcHMucGF0aWVudERhdGEuZW1haWwsXHJcbiAgICAgICAgcGF0aWVudElEOiBwcm9wcy5wYXRpZW50RGF0YS5wYXRpZW50SUQsXHJcbiAgICAgICAgdml0YWxzOiBwcm9wcy5wYXRpZW50RGF0YS5jdXJWaXRhbHNcclxuICAgIH1cclxuXHJcbiAgICAvLyBOb3RlOiBtb3N0IHBhdGllbnRzIHdpbGwgaGF2ZSB0aGUgc2FtZSB0eXBlcyBvZiB2aXRhbCBzaWducywgYnV0IHNvbWUgY291bGQgaGF2ZSBcclxuICAgIC8vIHNsaWdodGx5IGRpZmZlcmVudCBhbmQgbW9yZSBhZHZhbmNlZCBmZWF0dXJlcyB0byBkaXNwbGF5LiBJdCB3b3VsZCBiZSBuaWNlIHRvIG1ha2VcclxuICAgIC8vIHRoaXMgdGFibGUgZnVsbHkgY29tcGF0aWJsZSB3aXRoIGFsbCBkYXRhIHR5cGVzLCB3aXRob3V0IG1ha2luZyB0aGUgVUkgdG9vXHJcbiAgICAvLyBjb21wbGljYXRlZCBvciBjcm93ZGVkLlxyXG5cclxuICAgIHJldHVybiAoXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYXRpZW50RW50cnlcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2RpdmlzaW9uIG5hbWVzJz5cclxuICAgICAgICAgICAgICAgIDxoND57cGF0aWVudEluZm8ubmFtZX08L2g0PlxyXG4gICAgICAgICAgICAgICAgPHA+e3BhdGllbnRJbmZvLmZpcnN0TmFtZX08L3A+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZGl2aXNpb24gYWdlJz5cclxuICAgICAgICAgICAgICAgIDxoNT57cGF0aWVudEluZm8uYWdlfSBhbnM8L2g1PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2RpdmlzaW9uIHNleCc+XHJcbiAgICAgICAgICAgICAgICA8aDU+e3BhdGllbnRJbmZvLnNleH08L2g1PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2RpdmlzaW9uIGNvbnRhY3QnPlxyXG4gICAgICAgICAgICAgICAgPGg1PjxhIGhyZWY9e2BtYWlsdG86JHtwYXRpZW50SW5mby5jb250YWN0fWB9PkNvbnRhY3Q8L2E+PC9oNT5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdkaXZpc2lvbiB2aXRhbHMnPlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHBhdGllbnRJbmZvLnZpdGFscykubWFwKChlbGVtLGNvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e2NvdW50fSBjbGFzc05hbWU9J3ZpdGFsVW5pdCc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSd0eXBlJz57cGFyc2UoZm9ybWF0SGVhZGVycyhlbGVtWzBdKSl9PC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNSBjbGFzc05hbWU9J3ZhbHVlJz57ZWxlbVsxXX08L2g1PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2RpdmlzaW9uIGV5ZScgb25DbGljaz17ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHMuc2hvd1BhdGllbnQocGF0aWVudEluZm8ucGF0aWVudElEKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0+XHJcbiAgICAgICAgICAgICAgICA8aW1nIFxyXG4gICAgICAgICAgICAgICAgICAgIHNyYz0nYXNzZXRzL2ltZy9leWUucG5nJ1xyXG4gICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdkaXZpc2lvbiBkZWxldGUnIG9uQ2xpY2s9eygpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHMuZGVsZXRlUGF0aWVudChwYXRpZW50SW5mby5wYXRpZW50SUQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0+XHJcbiAgICAgICAgICAgICAgICA8aW1nIFxyXG4gICAgICAgICAgICAgICAgICAgIHNyYz0nYXNzZXRzL2ltZy9iaW4ucG5nJ1xyXG4gICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICApXHJcbn0iLCJpbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XHJcblxyXG5jb25zdCBVUkwgPSBcImh0dHBzOi8vY2xlaW8tc2VydmVyLmhlcm9rdWFwcC5jb20vYXBpXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2VuZEdldFJlcXVlc3Qocm91dGUsIHBhcmFtcyl7XHJcblxyXG4gICAgY29uc3QgY3VyUGFyYW1zID0ge1xyXG4gICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBmZXRjaChgJHtVUkx9JHtyb3V0ZX1gLCBjdXJQYXJhbXMpXHJcbiAgICAgICAgLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNwLmpzb24oKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBzZW5kaW5nIEdldCByZXF1ZXN0OiAnLCBlKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNlbmRQb3N0UmVxdWVzdChyb3V0ZSxwYXJhbXMsYm9keSl7XHJcbiAgICBjb25zdCBjdXJQYXJhbXMgPSB7XHJcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBmZXRjaChgJHtVUkx9JHtyb3V0ZX1gLCBjdXJQYXJhbXMpXHJcbiAgICAgICAgLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNwLmpzb24oKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBzZW5kaW5nIFBvc3QgcmVxdWVzdDonLGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9KVxyXG59IiwiaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IHVzZU1vZGFsIGZyb20gXCIuL3VzZU1vZGFsXCI7XHJcbmltcG9ydCB7IHVzZUludGVydmFsIH0gZnJvbSBcIi4vdXNlSW50ZXJ2YWxcIjtcclxuaW1wb3J0IE1vZGFsQWRkUGF0aWVudCBmcm9tIFwiLi9Nb2RhbEFkZFBhdGllbnRcIjtcclxuaW1wb3J0IE1vZGFsVmlld1BhdGllbnQgZnJvbSBcIi4vTW9kYWxWaWV3UGF0aWVudFwiO1xyXG5pbXBvcnQgeyBQYXRpZW50RW50cnkgfSBmcm9tIFwiLi9QYXRpZW50RW50cnlcIjtcclxuaW1wb3J0IHsgc2VuZEdldFJlcXVlc3QsIHNlbmRQb3N0UmVxdWVzdCB9IGZyb20gXCIuLi9yZXF1ZXN0ZXJcIjtcclxuaW1wb3J0IHsgcm91dGVzIH0gZnJvbSBcIi4uL3V0aWxpdGllc1wiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIERhc2hib2FyZChwcm9wcyl7XHJcblxyXG4gICAgY29uc3QgW2xpc3RlZFBhdGllbnRzLCBzZXRMaXN0ZWRQYXRpZW50c10gPSB1c2VTdGF0ZShudWxsKTtcclxuICAgIGNvbnN0IFtuZXdQYXRpZW50T3BlbmVkLCBzZXRNb2RhbE5ld1BhdGllbnRdID0gdXNlTW9kYWwoKTtcclxuICAgIGNvbnN0IFt2aWV3UGF0aWVudE9wZW5lZCwgc2V0TW9kYWxWaWV3UGF0aWVudF0gPSB1c2VNb2RhbCgpO1xyXG4gICAgY29uc3QgW3ZpZXdQYXRpZW50T2JqLCBzZXRWaWV3UGF0aWVudE9ial0gPSB1c2VTdGF0ZShudWxsKTtcclxuICAgIGNvbnN0IFt2aWV3UGF0aWVudFZpdGFscywgc2V0Vmlld1BhdGllbnRWaXRhbHNdID0gdXNlU3RhdGUobnVsbCk7XHJcblxyXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgICAgICB1cGRhdGVQYXRpZW50TGlzdCgpO1xyXG4gICAgfSwgW10pO1xyXG5cclxuICAgIHVzZUludGVydmFsKCgpID0+IHtcclxuICAgICAgICB1cGRhdGVQYXRpZW50TGlzdCgpO1xyXG4gICAgICAgIGlmKHZpZXdQYXRpZW50T2JqKXtcclxuICAgICAgICAgICAgdXBkYXRlVmlld2VkUGF0aWVudFZpdGFscyh2aWV3UGF0aWVudE9iai5wYXRpZW50SUQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sIDEwMDAwKVxyXG5cclxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICAgXHJcbiAgICB9LCBbdmlld1BhdGllbnRPYmpdKVxyXG5cclxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICB9LCBbdmlld1BhdGllbnRWaXRhbHNdKVxyXG5cclxuICAgIGNvbnN0IHVwZGF0ZVBhdGllbnRMaXN0ID0gKCkgPT4ge1xyXG4gICAgICAgIHNlbmRHZXRSZXF1ZXN0KHJvdXRlcy5nZXRBbGxQYXRpZW50cylcclxuICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBzZXRMaXN0ZWRQYXRpZW50cyhyZXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdXBkYXRlVmlld2VkUGF0aWVudFZpdGFscyA9IChpZCkgPT4ge1xyXG4gICAgICAgIHNlbmRHZXRSZXF1ZXN0KGAke3JvdXRlcy5nZXRWaXRhbHNmb3JQYXRpZW50fSR7aWR9YCwgbnVsbClcclxuICAgICAgICAudGhlbihyZSA9PiB7XHJcbiAgICAgICAgICAgIGlmKHJlLnJlc3VsdHMpe1xyXG4gICAgICAgICAgICAgICAgc2V0Vmlld1BhdGllbnRWaXRhbHMocmUucmVzdWx0cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGFkZFBhdGllbnQgPSAob2JqKSA9PiB7XHJcbiAgICAgICAgc2VuZFBvc3RSZXF1ZXN0KHJvdXRlcy5wb3N0U2luZ2xlUGF0aWVudCwgbnVsbCwgb2JqKVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIHVwZGF0ZVBhdGllbnRMaXN0KCk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBkZWxldGVQYXRpZW50ID0gKGlkKSA9PiB7XHJcbiAgICAgICAgc2VuZFBvc3RSZXF1ZXN0KGAke3JvdXRlcy5kZWxldGVTaW5nbGVQYXRpZW50fSR7aWR9YCwgbnVsbCwge30pXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVQYXRpZW50TGlzdCgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHNob3dQYXRpZW50ID0gKGlkKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcGF0aWVudElEID0gcGFyc2VJbnQoaWQpO1xyXG4gICAgICAgIHNldE1vZGFsVmlld1BhdGllbnQodHJ1ZSk7XHJcbiAgICAgICAgc2VuZEdldFJlcXVlc3QoYCR7cm91dGVzLmdldFNpbmdsZVBhdGllbnR9JHtwYXRpZW50SUR9YCwgbnVsbClcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGlmKHJlcy5yZXN1bHRzKXtcclxuICAgICAgICAgICAgICAgICAgICBzZXRWaWV3UGF0aWVudE9iaihyZXMucmVzdWx0cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVmlld2VkUGF0aWVudFZpdGFscyhwYXRpZW50SUQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWFpbmZyYW1lXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhZGVyXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxhYmVsSG9sZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGgyPlRhYmxlYXUgZGUgYm9yZDwvaDI+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uSG9sZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXtzZXRNb2RhbE5ld1BhdGllbnR9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8cD5Bam91dGVyPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhdGllbnRMaXN0XCI+XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVkUGF0aWVudHMgPyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGVkUGF0aWVudHMubWFwKChlbGVtLGNvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gPFBhdGllbnRFbnRyeSBrZXk9e2NvdW50fSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aWVudERhdGE9e2VsZW19IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVQYXRpZW50PXtkZWxldGVQYXRpZW50fSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1BhdGllbnQ9e3Nob3dQYXRpZW50fS8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaW5rLWhvbGRlclwiPlxyXG4gICAgICAgICAgICAgICAgPHA+PGEgaHJlZj1cImh0dHBzOi8vZG9jcy5nb29nbGUuY29tL3ByZXNlbnRhdGlvbi9kLzFZdXZydjZWbk40MTNtOEtudEpjZlc2MFV3NVdRZDdCNVhKeWpiaWFES19ZL2VkaXQ/dXNwPXNoYXJpbmdcIj5MaW5rIHRvIHByZXNlbnRhdGlvbjwvYT48L3A+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8TW9kYWxBZGRQYXRpZW50IFxyXG4gICAgICAgICAgICAgICAgaXNPcGVuZWQ9e25ld1BhdGllbnRPcGVuZWR9XHJcbiAgICAgICAgICAgICAgICBoaWRlPXtzZXRNb2RhbE5ld1BhdGllbnR9XHJcbiAgICAgICAgICAgICAgICBhY3Rpb249e2FkZFBhdGllbnR9XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgIDxNb2RhbFZpZXdQYXRpZW50IFxyXG4gICAgICAgICAgICAgICAgaXNPcGVuZWQ9e3ZpZXdQYXRpZW50T3BlbmVkfVxyXG4gICAgICAgICAgICAgICAgaGlkZT17KCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldE1vZGFsVmlld1BhdGllbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXRWaWV3UGF0aWVudE9iaihudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXRWaWV3UGF0aWVudFZpdGFscyhudWxsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHBhdGllbnQ9e3ZpZXdQYXRpZW50T2JqfVxyXG4gICAgICAgICAgICAgICAgdml0YWxzPXt2aWV3UGF0aWVudFZpdGFsc31cclxuICAgICAgICAgICAgICAgIGFjdGlvbj17KCkgPT4ge2NvbnNvbGUubG9nKCdub3QgaW1wbGVtZW50ZWQuJyl9fVxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgKVxyXG5cclxufSIsImltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tIFwicmVhY3RcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1c2VJbnRlcnZhbChjYWxsYmFjaywgZGVsYXkpe1xyXG5cclxuICAgIGNvbnN0IHNhdmVkQ0IgPSB1c2VSZWYoKTtcclxuXHJcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgICAgIHNhdmVkQ0IuY3VycmVudCA9IGNhbGxiYWNrO1xyXG4gICAgfSwgW2NhbGxiYWNrXSk7XHJcblxyXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgICAgICBmdW5jdGlvbiB0aWNrKCl7XHJcbiAgICAgICAgICAgIHNhdmVkQ0IuY3VycmVudCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihkZWxheSAhPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIGxldCBpZCA9IHNldEludGVydmFsKHRpY2ssIGRlbGF5KTtcclxuICAgICAgICAgICAgcmV0dXJuICgpID0+IGNsZWFySW50ZXJ2YWwoaWQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sIFtkZWxheV0pO1xyXG5cclxufSIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmltcG9ydCAnLi4vYXNzZXRzL3N0eWxlcy9zdHlsZS5zY3NzJztcclxuaW1wb3J0ICogYXMgZDMgZnJvbSAnZDMnO1xyXG5pbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBSZWFjdERPTSBmcm9tIFwicmVhY3QtZG9tL2NsaWVudFwiO1xyXG5pbXBvcnQgeyBEYXNoYm9hcmQgfSBmcm9tICcuL2NvbXBvbmVudHMvRGFzaGJvYXJkJztcclxuXHJcbmNvbnN0IHJvb3QgPSBSZWFjdERPTS5jcmVhdGVSb290KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicm9vdFwiKSk7XHJcbnJvb3QucmVuZGVyKFxyXG4gICAgPERhc2hib2FyZCAvPlxyXG4pXHJcblxyXG4iXSwibmFtZXMiOlsidXNlTW9kYWwiLCJpc09wZW5lZCIsInNldE9wZW5lZCIsInVzZVN0YXRlIiwic2V4T3B0aW9ucyIsImxhYmVsIiwiZm9ybWF0SGVhZGVycyIsInZhbHVlIiwiZW1haWxSZWdleCIsIm9uU2VsZWN0U2V4IiwiZSIsImQzIiwiY2xhc3NlZCIsInRhcmdldCIsImdldFNlbGVjdGVkU2V4Iiwic2VsZWN0ZWRCdG4iLCJub2RlIiwiaW5uZXJUZXh0IiwidmVyaWZ5SW5wdXQiLCJjdXJUYXJnZXQiLCJjdXJWYWx1ZSIsInZlcmlmaWVkU3RhdGUiLCJpZCIsIlN0cmluZyIsImxlbmd0aCIsIm51bSIsInBhcnNlSW50IiwiaXNOYU4iLCJ0ZXN0IiwicmVzZXRJbnB1dERlY29yYXRpb24iLCJ2ZXJpZnlBbGxJbnB1dHMiLCJzZWxlY3Rpb24iLCJub2RlcyIsInZlcmlmaWVkT2JqIiwibWFwIiwiY3VyQ2hlY2tlZElucHV0IiwiYnBtIiwic2tpbnRlbXAiLCJzcG8yIiwiX3JlZiIsImhpZGUiLCJhY3Rpb24iLCJSZWFjdERPTSIsIlJlYWN0IiwiY2xhc3NOYW1lIiwidGFiSW5kZXgiLCJyb2xlIiwib25CbHVyIiwib25JbnB1dCIsIm9wdGlvbiIsImNvdW50Iiwia2V5Iiwib25DbGljayIsImRvY3VtZW50IiwiYm9keSIsInBhdGllbnQiLCJ2aXRhbHMiLCJzcmMiLCJmaXJzdE5hbWUiLCJuYW1lIiwiYWdlIiwic2V4IiwiZm9ybWF0U2V4IiwiZW1haWwiLCJjZWxsU3BhY2luZyIsImhlYWRlcnMiLCJ2aXRhbEhlYWRlciIsInBhcnNlIiwiY2FsY3VsYXRlU3RhdHMiLCJkYXRhIiwidml0YWxIZWFkZXJzIiwic3VtbWVkRGF0YSIsInNsaWNlIiwiZm9yRWFjaCIsImVsZW0iLCJpIiwiT2JqZWN0IiwiZW50cmllcyIsIm1lYXN1cmVtZW50VmFsdWUiLCJpZHgiLCJjdXJNZWFzdXJlbWVudFR5cGUiLCJjdXJNZWFzdXJlbWVudFZhbHVlIiwicGFyc2VGbG9hdCIsImtleXMiLCJ0b0ZpeGVkIiwidmFsdWVzIiwibWVhc3VyZW1lbnRzIiwicmV2ZXJzZSIsIm1lYXN1cmVtZW50IiwiUGF0aWVudEVudHJ5IiwicHJvcHMiLCJwYXRpZW50SW5mbyIsInBhdGllbnREYXRhIiwiY29udGFjdCIsInBhdGllbnRJRCIsImN1clZpdGFscyIsImhyZWYiLCJzaG93UGF0aWVudCIsImRlbGV0ZVBhdGllbnQiLCJVUkwiLCJzZW5kR2V0UmVxdWVzdCIsInJvdXRlIiwicGFyYW1zIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwicmVzcCIsImpzb24iLCJyZXN1bHQiLCJjYXRjaCIsImNvbnNvbGUiLCJsb2ciLCJzZW5kUG9zdFJlcXVlc3QiLCJjdXJQYXJhbXMiLCJKU09OIiwic3RyaW5naWZ5IiwiRGFzaGJvYXJkIiwibGlzdGVkUGF0aWVudHMiLCJzZXRMaXN0ZWRQYXRpZW50cyIsIm5ld1BhdGllbnRPcGVuZWQiLCJzZXRNb2RhbE5ld1BhdGllbnQiLCJ2aWV3UGF0aWVudE9wZW5lZCIsInNldE1vZGFsVmlld1BhdGllbnQiLCJ2aWV3UGF0aWVudE9iaiIsInNldFZpZXdQYXRpZW50T2JqIiwidmlld1BhdGllbnRWaXRhbHMiLCJzZXRWaWV3UGF0aWVudFZpdGFscyIsInVzZUVmZmVjdCIsInVwZGF0ZVBhdGllbnRMaXN0IiwiY2FsbGJhY2siLCJkZWxheSIsInNhdmVkQ0IiLCJ1c2VSZWYiLCJjdXJyZW50Iiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwidXNlSW50ZXJ2YWwiLCJ1cGRhdGVWaWV3ZWRQYXRpZW50Vml0YWxzIiwicmVzIiwicmUiLCJyZXN1bHRzIiwiTW9kYWxBZGRQYXRpZW50Iiwib2JqIiwiTW9kYWxWaWV3UGF0aWVudCIsImdldEVsZW1lbnRCeUlkIiwicmVuZGVyIl0sInNvdXJjZVJvb3QiOiIifQ==