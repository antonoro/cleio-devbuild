"use strict";(self.webpackChunkfront_cleio=self.webpackChunkfront_cleio||[]).push([[179],{48734:(e,t,a)=>{var l=a(89346),n=a(67294),r=a(20745);const s=()=>{const[e,t]=(0,n.useState)(!1);return[e,function(){t(!e)}]};var c=a(73935);const m=[{label:"M"},{label:"F"},{label:"Autre"}],i=e=>{switch(e){case"bpm":return"bpm";case"skintemp":return"T&deg;";case"spo2":return"SpO<sub>2</sub>";default:return""}},o=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,d=e=>{l.td_(".radioOption").classed("selected",!1),l.Ys(e.target).classed("selected",!0)},u=()=>{const e=l.Ys(".selected");return e.node()?"Autre"===e.node().innerText?"A":"M"===e.node().innerText||"F"===e.node().innerText?e.node().innerText:"N/A":null},E=(e,t)=>{let a;e?a=e.target:t&&(a=t);const n=a.value;let r,s=!1;if("name"===a.id||"firstName"===a.id)s=String(n).length>0,r=String(n);else if("age"===a.id){const e=parseInt(String(n));s=!isNaN(e),r=e}else"email"===a.id&&(s=o.test(n),r=n);return l.Ys(a).classed(s?"valid":"error",!0),e?s:t?[s,r,a.id]:void 0},p=e=>{l.Ys(e.target).classed("valid",!1),l.Ys(e.target).classed("error",!1)},v=()=>{const e=l.td_("input").nodes();let t=!0,a={};return e.map((e=>{let l=E(null,e);l[0]?a[`${l[2]}`]=l[1]:t=!1})),u()?a.sex=u():t=!1,a.curVitals={bpm:0,skintemp:0,spo2:0},[t,a]},h=e=>{let{isOpened:t,hide:a,action:l}=e;return t?c.createPortal(n.createElement(n.Fragment,null,n.createElement("div",{className:"modal-overlay"}),n.createElement("div",{className:"modal-wrapper","aria-modal":!0,"aria-hidden":!0,tabIndex:-1,role:"dialog"},n.createElement("div",{className:"modal"},n.createElement("div",{className:"modal-header"},n.createElement("h2",null,"Ajouter un patient")),n.createElement("form",null,n.createElement("div",{className:"form-group"},n.createElement("div",{className:"holder label"},n.createElement("label",null,"Nom")),n.createElement("div",{className:"holder input"},n.createElement("input",{className:"form-control",id:"name",onBlur:e=>{E(e,null)},onInput:p}))),n.createElement("div",{className:"form-group"},n.createElement("div",{className:"holder label"},n.createElement("label",null,"Prénom")),n.createElement("div",{className:"holder input"},n.createElement("input",{className:"form-control",id:"firstName",onBlur:e=>{E(e,null)},onInput:p}))),n.createElement("div",{className:"form-group"},n.createElement("div",{className:"holder label"},n.createElement("label",null,"Âge")),n.createElement("div",{className:"holder input"},n.createElement("input",{className:"form-control",id:"age",onBlur:e=>{E(e,null)},onInput:p}))),n.createElement("div",{className:"form-group"},n.createElement("div",{className:"holder label"},n.createElement("label",null,"Sexe")),n.createElement("div",{className:"holder input"},n.createElement("div",{className:"radioHolder"},m.map(((e,t)=>n.createElement("div",{key:`${e.label}`,className:"radioOption",onClick:d},n.createElement("p",null,e.label))))))),n.createElement("div",{className:"form-group"},n.createElement("div",{className:"holder label"},n.createElement("label",null,"Email")),n.createElement("div",{className:"holder input"},n.createElement("input",{className:"form-control",id:"email",onBlur:e=>{E(e,null)},onInput:p})))),n.createElement("div",{className:"btnArray"},n.createElement("div",{className:"btnHolder"},n.createElement("div",{className:"btn cancel",onClick:a},n.createElement("p",null,"Annuler"))),n.createElement("div",{className:"btnHolder"},n.createElement("div",{className:"btn accept",onClick:()=>{v()[0]&&(l(v()[1]),a())}},n.createElement("p",null,"Confirmer"))))))),document.body):null};var N=a(25935);const f=(e,t,a)=>{let l={};return a.forEach(((a,n)=>{const r=Array.from(t).sort(((t,l)=>{const n=t[1],r=l[1];return e?r[a]-n[a]:n[a]-r[a]}))[0];l[a]=r[1][a]})),[l,e?"Maximum":"Minimum"]},b=(e,t,a)=>{let l;const r=t.slice(0,30);switch(e){case"mean":l=((e,t)=>{let a={};return t.forEach(((t,l)=>{const n=Array.from(e).reduce(((e,a)=>e+a[1][t]),0);a[t]="bpm"===t?parseInt(n/Array.from(e).length):parseFloat(parseFloat(n/Array.from(e).length).toFixed("skintemp"===t?2:3))})),[a,"Moyenne"]})(r,a);break;case"max":l=f(!0,r,a);break;case"min":l=f(!1,r,a)}return n.createElement("tr",{className:"vitalrow"},n.createElement("td",null,l[1]),Object.values(l[0]).map(((e,t)=>n.createElement("td",{key:t},e))))},g=e=>{let{isOpened:t,hide:a,patient:l,vitals:r,action:s}=e;return t?c.createPortal(n.createElement(n.Fragment,null,n.createElement("div",{className:"modal-overlay"}),n.createElement("div",{className:"modal-wrapper","aria-modal":!0,"aria-hidden":!0,tabIndex:-1,role:"dialog"},n.createElement("div",{className:"modal"},n.createElement("div",{className:"x-holder"},n.createElement("img",{onClick:a,src:"assets/img/x.png"})),n.createElement("div",{className:"modal-header"},n.createElement("h2",null,"Visualiser un patient")),l?n.createElement("div",{className:"modal-body"},n.createElement("div",{className:"modal-unit inline"},n.createElement("p",null,l.firstName," "),n.createElement("p",null,n.createElement("b",null,l.name))),n.createElement("div",{className:"modal-unit inline"},n.createElement("p",null,l.age," ans • "),n.createElement("p",null,(e=>{switch(e){case"F":return"Femme";case"M":return"Homme";case"A":return"Autre";default:return"N/A"}})(l.sex))),n.createElement("div",{className:"modal-unit inline"},n.createElement("p",null,l.email))):null,n.createElement("div",{className:"table-holder"},l&&r?n.createElement("table",{className:"vitals-table",cellSpacing:"0"},n.createElement("thead",{className:"vitalheaderrow"},n.createElement("tr",null,n.createElement("th",null),r.headers.map(((e,t)=>n.createElement("th",{key:t},(0,N.ZP)(i(e)))))),n.createElement("tr",null,n.createElement("td",null,n.createElement("h3",null,"Statistiques (5 dernières minutes)")),r.headers.map(((e,t)=>n.createElement("td",{key:t}," ")))),b("mean",Object.entries(r.measurements).reverse(),r.headers),b("max",Object.entries(r.measurements).reverse(),r.headers),b("min",Object.entries(r.measurements).reverse(),r.headers),n.createElement("tr",null,n.createElement("td",null,n.createElement("h3",null,"Données")),r.headers.map(((e,t)=>n.createElement("td",{key:t}," "))))),n.createElement("tbody",{className:"data-holder"},Object.entries(r.measurements).reverse().map(((e,t)=>n.createElement("tr",{className:"vitalrow",key:t},n.createElement("td",null,e[0]),Object.entries(e[1]).map(((e,t)=>n.createElement("td",{key:t},e[1])))))))):null)))),document.body):null};function y(e){const t={name:e.patientData.name,firstName:e.patientData.firstName,age:e.patientData.age,sex:e.patientData.sex,contact:e.patientData.email,patientID:e.patientData.patientID,vitals:e.patientData.curVitals};return n.createElement("div",{className:"patientEntry"},n.createElement("div",{className:"division names"},n.createElement("h4",null,t.name),n.createElement("p",null,t.firstName)),n.createElement("div",{className:"division age"},n.createElement("h5",null,t.age," ans")),n.createElement("div",{className:"division sex"},n.createElement("h5",null,t.sex)),n.createElement("div",{className:"division contact"},n.createElement("h5",null,n.createElement("a",{href:`mailto:${t.contact}`},"Contact"))),n.createElement("div",{className:"division vitals"},Object.entries(t.vitals).map(((e,t)=>n.createElement("div",{key:t,className:"vitalUnit"},n.createElement("p",{className:"type"},(0,N.ZP)(i(e[0]))),n.createElement("h5",{className:"value"},e[1]))))),n.createElement("div",{className:"division eye",onClick:()=>{e.showPatient(t.patientID)}},n.createElement("img",{src:"assets/img/eye.png"})),n.createElement("div",{className:"division delete",onClick:()=>{e.deletePatient(t.patientID)}},n.createElement("img",{src:"assets/img/bin.png"})))}const k="https://cleio-server.herokuapp.com/api";function w(e,t){return fetch(`${k}${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((e=>e.json())).then((e=>e)).catch((e=>(console.log("Error sending Get request: ",e),null)))}function x(e,t,a){const l={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)};return fetch(`${k}${e}`,l).then((e=>e.json())).then((e=>e)).catch((e=>(console.log("Error sending Post request:",e),null)))}function O(e){const[t,a]=(0,n.useState)(null),[l,r]=s(),[c,m]=s(),[i,o]=(0,n.useState)(null),[d,u]=(0,n.useState)(null);(0,n.useEffect)((()=>{E()}),[]),function(e,t){const a=(0,n.useRef)();(0,n.useEffect)((()=>{a.current=e}),[e]),(0,n.useEffect)((()=>{{let e=setInterval((function(){a.current()}),t);return()=>clearInterval(e)}}),[t])}((()=>{E(),i&&p(i.patientID)}),1e4),(0,n.useEffect)((()=>{}),[i]),(0,n.useEffect)((()=>{}),[d]);const E=()=>{w("/patients").then((e=>{a(e)}))},p=e=>{w(`/vitals/${e}`).then((e=>{e.results&&u(e.results)}))},v=e=>{x(`/patients/delete/${e}`,0,{}).then((e=>{E()}))},N=e=>{const t=parseInt(e);m(!0),w(`/patients/${t}`).then((e=>{e.results&&(o(e.results),p(t))}))};return n.createElement("div",{className:"mainframe"},n.createElement("div",{className:"header"},n.createElement("div",{className:"labelHolder"},n.createElement("h2",null,"Tableau de bord")),n.createElement("div",{className:"buttonHolder"},n.createElement("div",{className:"btn",onClick:r},n.createElement("p",null,"Ajouter")))),n.createElement("div",{className:"patientList"},t?t.map(((e,t)=>n.createElement(y,{key:t,patientData:e,deletePatient:v,showPatient:N}))):""),n.createElement("div",{className:"link-holder"},n.createElement("p",null,n.createElement("a",{href:"https://docs.google.com/presentation/d/1Yuvrv6VnN413m8KntJcfW60Uw5WQd7B5XJyjbiaDK_Y/edit?usp=sharing"},"Link to presentation"))),n.createElement(h,{isOpened:l,hide:r,action:e=>{x("/patients/new",0,e).then((e=>{E()}))}}),n.createElement(g,{isOpened:c,hide:()=>{m(),o(null),u(null)},patient:i,vitals:d,action:()=>{console.log("not implemented.")}}))}r.createRoot(document.getElementById("root")).render(n.createElement(O,null))}},e=>{var t=t=>e(e.s=t);e.O(0,[216],(()=>(t(28594),t(35666),t(48734)))),e.O()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixFQUFNOEIsR0FDL0NyQyxNQUFLaUMsSUFDRlYsR0FBbUIsR0FDckIsSUF3REVwRyxFQUFBQSxjQUFDbUgsRUFBZ0IsQ0FDYjdKLFNBQVV1SSxFQUNWaEcsS0FBTUEsS0FDRmlHLElBQ0FFLEVBQWtCLE1BQ2xCRSxFQUFxQixLQUFLLEVBRzlCdkQsUUFBU29ELEVBQ1RuRCxPQUFRcUQsRUFDUm5HLE9BQVFBLEtBQU9vRixRQUFRQyxJQUFJLG1CQUFtQixJQUs5RCxDRXRIYXBGLEVBQUFBLFdBQW9CVyxTQUFTMEcsZUFBZSxTQUNwREMsT0FDRHJILEVBQUFBLGNBQUN3RixFQUFTLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mcm9udC1jbGVpby8uL3NyYy9hcHAvY29tcG9uZW50cy91c2VNb2RhbC5qcyIsIndlYnBhY2s6Ly9mcm9udC1jbGVpby8uL3NyYy9hcHAvdXRpbGl0aWVzLmpzIiwid2VicGFjazovL2Zyb250LWNsZWlvLy4vc3JjL2FwcC9jb21wb25lbnRzL01vZGFsQWRkUGF0aWVudC5qcyIsIndlYnBhY2s6Ly9mcm9udC1jbGVpby8uL3NyYy9hcHAvY29tcG9uZW50cy9Nb2RhbFZpZXdQYXRpZW50LmpzIiwid2VicGFjazovL2Zyb250LWNsZWlvLy4vc3JjL2FwcC9jb21wb25lbnRzL1BhdGllbnRFbnRyeS5qcyIsIndlYnBhY2s6Ly9mcm9udC1jbGVpby8uL3NyYy9hcHAvcmVxdWVzdGVyLmpzIiwid2VicGFjazovL2Zyb250LWNsZWlvLy4vc3JjL2FwcC9jb21wb25lbnRzL0Rhc2hib2FyZC5qcyIsIndlYnBhY2s6Ly9mcm9udC1jbGVpby8uL3NyYy9hcHAvY29tcG9uZW50cy91c2VJbnRlcnZhbC5qcyIsIndlYnBhY2s6Ly9mcm9udC1jbGVpby8uL3NyYy9hcHAvYXBwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xyXG5cclxuY29uc3QgdXNlTW9kYWwgPSAoKSA9PiB7XHJcbiAgY29uc3QgW2lzT3BlbmVkLCBzZXRPcGVuZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xyXG5cclxuICBmdW5jdGlvbiB0b2dnbGUoKSB7XHJcbiAgICBzZXRPcGVuZWQoIWlzT3BlbmVkKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBbXHJcbiAgICBpc09wZW5lZCxcclxuICAgIHRvZ2dsZVxyXG4gIF1cclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHVzZU1vZGFsOyIsImV4cG9ydCBjb25zdCByb3V0ZXMgPSB7XHJcbiAgICBnZXRBbGxQYXRpZW50czogXCIvcGF0aWVudHNcIixcclxuICAgIGdldFNpbmdsZVBhdGllbnQ6IFwiL3BhdGllbnRzL1wiLFxyXG4gICAgZ2V0Vml0YWxzZm9yUGF0aWVudDogXCIvdml0YWxzL1wiLFxyXG4gICAgcG9zdFNpbmdsZVBhdGllbnQ6IFwiL3BhdGllbnRzL25ld1wiLFxyXG4gICAgZGVsZXRlU2luZ2xlUGF0aWVudDogXCIvcGF0aWVudHMvZGVsZXRlL1wiXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3Qgc2V4T3B0aW9ucyA9IFtcclxuICAgIHtcclxuICAgICAgICBsYWJlbDpcIk1cIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBsYWJlbDpcIkZcIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBsYWJlbDpcIkF1dHJlXCJcclxuICAgIH1cclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtYXRIZWFkZXJzID0gKHZhbHVlKSA9PiB7XHJcbiAgICBzd2l0Y2godmFsdWUpe1xyXG4gICAgICAgIGNhc2UgXCJicG1cIjpcclxuICAgICAgICAgICAgcmV0dXJuIFwiYnBtXCI7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIGNhc2UgXCJza2ludGVtcFwiOlxyXG4gICAgICAgICAgICByZXR1cm4gYFQkeycmZGVnOyd9YDtcclxuXHJcbiAgICAgICAgY2FzZSBcInNwbzJcIjpcclxuICAgICAgICAgICAgcmV0dXJuIGBTcE88c3ViPjI8L3N1Yj5gO1xyXG5cclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgIH1cclxuICAgIFxyXG59IiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgUmVhY3RET00gZnJvbSBcInJlYWN0LWRvbVwiO1xyXG5pbXBvcnQgeyBzZXhPcHRpb25zIH0gZnJvbSBcIi4uL3V0aWxpdGllc1wiO1xyXG5pbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XHJcblxyXG5jb25zdCBlbWFpbFJlZ2V4ID0gL15cXHcrKFtcXC4tXT9cXHcrKSpAXFx3KyhbXFwuLV0/XFx3KykqKFxcLlxcd3syLDN9KSskLztcclxuXHJcbmNvbnN0IG9uU2VsZWN0U2V4ID0gKGUpID0+IHtcclxuICAgIGQzLnNlbGVjdEFsbCgnLnJhZGlvT3B0aW9uJykuY2xhc3NlZCgnc2VsZWN0ZWQnLCBmYWxzZSk7XHJcbiAgICBkMy5zZWxlY3QoZS50YXJnZXQpLmNsYXNzZWQoJ3NlbGVjdGVkJywgdHJ1ZSk7XHJcbn1cclxuXHJcbmNvbnN0IGdldFNlbGVjdGVkU2V4ID0gKCkgPT4ge1xyXG4gICAgY29uc3Qgc2VsZWN0ZWRCdG49IGQzLnNlbGVjdCgnLnNlbGVjdGVkJyk7XHJcbiAgICBpZihzZWxlY3RlZEJ0bi5ub2RlKCkpe1xyXG4gICAgICAgIGlmKHNlbGVjdGVkQnRuLm5vZGUoKS5pbm5lclRleHQgPT09IFwiQXV0cmVcIil7XHJcbiAgICAgICAgICAgIHJldHVybiBcIkFcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZihzZWxlY3RlZEJ0bi5ub2RlKCkuaW5uZXJUZXh0ID09PSBcIk1cIiB8fFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRCdG4ubm9kZSgpLmlubmVyVGV4dCA9PT0gXCJGXCIpe1xyXG4gICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRCdG4ubm9kZSgpLmlubmVyVGV4dDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuIFwiTi9BXCI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufVxyXG5cclxuY29uc3QgdmVyaWZ5SW5wdXQgPSAoZSwgdGFyZ2V0KSA9PiB7XHJcbiAgICBsZXQgY3VyVGFyZ2V0O1xyXG4gICAgaWYoZSl7XHJcbiAgICAgICAgY3VyVGFyZ2V0ID0gZS50YXJnZXQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKHRhcmdldCl7XHJcbiAgICAgICAgY3VyVGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgfVxyXG4gICAgY29uc3QgY3VyVmFsdWUgPSBjdXJUYXJnZXQudmFsdWU7XHJcbiAgICBsZXQgdmVyaWZpZWRTdGF0ZSA9IGZhbHNlO1xyXG4gICAgbGV0IHZhbHVlO1xyXG4gICAgaWYoY3VyVGFyZ2V0LmlkID09PSBcIm5hbWVcIiB8fCBjdXJUYXJnZXQuaWQgPT09IFwiZmlyc3ROYW1lXCIpe1xyXG4gICAgICAgIHZlcmlmaWVkU3RhdGUgPSBTdHJpbmcoY3VyVmFsdWUpLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgdmFsdWUgPSBTdHJpbmcoY3VyVmFsdWUpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZihjdXJUYXJnZXQuaWQgPT09IFwiYWdlXCIpe1xyXG4gICAgICAgIGNvbnN0IG51bSA9IHBhcnNlSW50KFN0cmluZyhjdXJWYWx1ZSkpO1xyXG4gICAgICAgIHZlcmlmaWVkU3RhdGUgPSAhaXNOYU4obnVtKTtcclxuICAgICAgICB2YWx1ZSA9IG51bTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYoY3VyVGFyZ2V0LmlkID09PSBcImVtYWlsXCIpe1xyXG4gICAgICAgIHZlcmlmaWVkU3RhdGUgPSBlbWFpbFJlZ2V4LnRlc3QoY3VyVmFsdWUpO1xyXG4gICAgICAgIHZhbHVlID0gY3VyVmFsdWU7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGQzLnNlbGVjdChjdXJUYXJnZXQpLmNsYXNzZWQoYCR7dmVyaWZpZWRTdGF0ZSA/IFwidmFsaWRcIjpcImVycm9yXCJ9YCwgdHJ1ZSk7XHJcbiAgICBcclxuICAgIGlmKGUpe1xyXG4gICAgICAgIHJldHVybiB2ZXJpZmllZFN0YXRlO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZih0YXJnZXQpe1xyXG4gICAgICAgIHJldHVybiBbdmVyaWZpZWRTdGF0ZSwgdmFsdWUsIGN1clRhcmdldC5pZF07XHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IHJlc2V0SW5wdXREZWNvcmF0aW9uID0gKGUpID0+IHtcclxuICAgIGQzLnNlbGVjdChlLnRhcmdldCkuY2xhc3NlZCgndmFsaWQnLCBmYWxzZSk7XHJcbiAgICBkMy5zZWxlY3QoZS50YXJnZXQpLmNsYXNzZWQoJ2Vycm9yJywgZmFsc2UpO1xyXG59XHJcblxyXG5jb25zdCB2ZXJpZnlBbGxJbnB1dHMgPSAoKSA9PiB7XHJcbiAgICBcclxuICAgIGNvbnN0IHNlbGVjdGlvbiA9IGQzLnNlbGVjdEFsbCgnaW5wdXQnKS5ub2RlcygpO1xyXG4gICAgbGV0IHZlcmlmaWVkU3RhdGUgPSB0cnVlO1xyXG4gICAgbGV0IHZlcmlmaWVkT2JqID0ge307XHJcbiAgICBzZWxlY3Rpb24ubWFwKG5vZGUgPT4ge1xyXG4gICAgICAgIGxldCBjdXJDaGVja2VkSW5wdXQgPSB2ZXJpZnlJbnB1dChudWxsLCBub2RlKTtcclxuICAgICAgICBpZighY3VyQ2hlY2tlZElucHV0WzBdKXtcclxuICAgICAgICAgICAgdmVyaWZpZWRTdGF0ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICB2ZXJpZmllZE9ialtgJHtjdXJDaGVja2VkSW5wdXRbMl19YF0gPSBjdXJDaGVja2VkSW5wdXRbMV07XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBpZighZ2V0U2VsZWN0ZWRTZXgoKSl7XHJcbiAgICAgICAgdmVyaWZpZWRTdGF0ZSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgICB2ZXJpZmllZE9ialtcInNleFwiXSA9IGdldFNlbGVjdGVkU2V4KCk7XHJcbiAgICB9XHJcblxyXG4gICAgdmVyaWZpZWRPYmpbXCJjdXJWaXRhbHNcIl0gPSB7XHJcbiAgICAgICAgYnBtOiAwLFxyXG4gICAgICAgIHNraW50ZW1wOiAwLFxyXG4gICAgICAgIHNwbzI6IDBcclxuICAgIH07XHJcbiAgICByZXR1cm4gW3ZlcmlmaWVkU3RhdGUsIHZlcmlmaWVkT2JqXTtcclxufVxyXG5cclxuY29uc3QgTW9kYWxBZGRQYXRpZW50ID0gKHsgaXNPcGVuZWQsIGhpZGUsIGFjdGlvbiB9KSA9PiBpc09wZW5lZCA/IFJlYWN0RE9NLmNyZWF0ZVBvcnRhbChcclxuICAgIFxyXG4gICAgPFJlYWN0LkZyYWdtZW50PlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtb3ZlcmxheVwiLz5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLXdyYXBwZXJcIiBhcmlhLW1vZGFsIGFyaWEtaGlkZGVuIHRhYkluZGV4PXstMX0gcm9sZT1cImRpYWxvZ1wiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsXCI+XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtaGVhZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGgyPkFqb3V0ZXIgdW4gcGF0aWVudDwvaDI+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxmb3JtPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9ybS1ncm91cFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvbGRlciBsYWJlbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPk5vbTwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvbGRlciBpbnB1dFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzTmFtZT1cImZvcm0tY29udHJvbFwiIGlkPVwibmFtZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25CbHVyPXsoZSkgPT4ge3ZlcmlmeUlucHV0KGUsbnVsbCl9fSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbklucHV0PXtyZXNldElucHV0RGVjb3JhdGlvbn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9ybS1ncm91cFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvbGRlciBsYWJlbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlByw6lub208L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob2xkZXIgaW5wdXRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzc05hbWU9XCJmb3JtLWNvbnRyb2xcIiBpZD1cImZpcnN0TmFtZVwiIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQmx1cj17KGUpID0+IHt2ZXJpZnlJbnB1dChlLG51bGwpfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbklucHV0PXtyZXNldElucHV0RGVjb3JhdGlvbn0vPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob2xkZXIgbGFiZWxcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD7DgmdlPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9sZGVyIGlucHV0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3NOYW1lPVwiZm9ybS1jb250cm9sXCIgaWQ9XCJhZ2VcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQmx1cj17KGUpID0+IHt2ZXJpZnlJbnB1dChlLG51bGwpfX0gXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25JbnB1dD17cmVzZXRJbnB1dERlY29yYXRpb259XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob2xkZXIgbGFiZWxcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5TZXhlPC9sYWJlbD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9sZGVyIGlucHV0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJhZGlvSG9sZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNleE9wdGlvbnMubWFwKChvcHRpb24sIGNvdW50KSA9PiBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e2Ake29wdGlvbi5sYWJlbH1gfSBjbGFzc05hbWU9XCJyYWRpb09wdGlvblwiIG9uQ2xpY2s9e29uU2VsZWN0U2V4fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD57b3B0aW9uLmxhYmVsfTwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob2xkZXIgbGFiZWxcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5FbWFpbDwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvbGRlciBpbnB1dFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzTmFtZT1cImZvcm0tY29udHJvbFwiIGlkPVwiZW1haWxcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQmx1cj17KGUpID0+IHt2ZXJpZnlJbnB1dChlLG51bGwpfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbklucHV0PXtyZXNldElucHV0RGVjb3JhdGlvbn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9mb3JtPlxyXG5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuQXJyYXlcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0bkhvbGRlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0biBjYW5jZWxcIiBvbkNsaWNrPXtoaWRlfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPkFubnVsZXI8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuSG9sZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuIGFjY2VwdFwiIG9uQ2xpY2s9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHZlcmlmeUFsbElucHV0cygpWzBdKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uKHZlcmlmeUFsbElucHV0cygpWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD5Db25maXJtZXI8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgPC9SZWFjdC5GcmFnbWVudD4sIGRvY3VtZW50LmJvZHlcclxuXHJcbilcclxuOlxyXG5udWxsO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgTW9kYWxBZGRQYXRpZW50O1xyXG5cclxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgUmVhY3RET00gZnJvbSBcInJlYWN0LWRvbVwiO1xyXG5pbXBvcnQgcGFyc2UgZnJvbSAnaHRtbC1yZWFjdC1wYXJzZXInO1xyXG5pbXBvcnQgeyBmb3JtYXRIZWFkZXJzIH0gZnJvbSBcIi4uL3V0aWxpdGllc1wiO1xyXG5cclxuY29uc3QgZm9ybWF0U2V4ID0gKHNleCkgPT4ge1xyXG4gICAgc3dpdGNoKHNleCl7XHJcbiAgICAgICAgY2FzZSBcIkZcIjpcclxuICAgICAgICAgICAgcmV0dXJuIFwiRmVtbWVcIjtcclxuICAgICAgICBjYXNlIFwiTVwiOlxyXG4gICAgICAgICAgICByZXR1cm4gXCJIb21tZVwiO1xyXG4gICAgICAgIGNhc2UgXCJBXCI6XHJcbiAgICAgICAgICAgIHJldHVybiBcIkF1dHJlXCI7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIFwiTi9BXCI7XHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IGNhbGN1bGF0ZU1lYW4gPSAoZGF0YSwgdml0YWxIZWFkZXJzKSA9PiB7XHJcbiAgICBcclxuICAgIGxldCBzdW1tZWREYXRhID0ge307XHJcblxyXG4gICAgdml0YWxIZWFkZXJzLmZvckVhY2goKHZpdGFsSGVhZGVyLCBjb3VudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHN1bW1lZFZhbHVlID0gQXJyYXkuZnJvbShkYXRhKS5yZWR1Y2UoKGFjYywgY3VyVmFsKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2MgKyBjdXJWYWxbMV1bdml0YWxIZWFkZXJdO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICAgIGlmKHZpdGFsSGVhZGVyID09PSBcImJwbVwiKXtcclxuICAgICAgICAgICAgc3VtbWVkRGF0YVt2aXRhbEhlYWRlcl0gPSBwYXJzZUludChzdW1tZWRWYWx1ZSAvIEFycmF5LmZyb20oZGF0YSkubGVuZ3RoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgc3VtbWVkRGF0YVt2aXRhbEhlYWRlcl0gPSBwYXJzZUZsb2F0KHBhcnNlRmxvYXQoc3VtbWVkVmFsdWUgLyBBcnJheS5mcm9tKGRhdGEpLmxlbmd0aCkudG9GaXhlZCh2aXRhbEhlYWRlciA9PT0gXCJza2ludGVtcFwiID8gMiA6IDMpKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gW3N1bW1lZERhdGEsIFwiTW95ZW5uZVwiXTtcclxufVxyXG5cclxuY29uc3QgY2FsY3VsYXRlTWF4TWluID0gKGlzTWF4LCBkYXRhLCB2aXRhbEhlYWRlcnMpID0+IHtcclxuICAgIGxldCBmaW5hbEFycmF5ID0ge307XHJcbiAgICBcclxuICAgIHZpdGFsSGVhZGVycy5mb3JFYWNoKCh2aXRhbEhlYWRlciwgY291bnQpID0+IHtcclxuICAgICAgICBjb25zdCBzb3J0ZWRNYXggPSBBcnJheS5mcm9tKGRhdGEpLnNvcnQoKGEsYikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjdXJBID0gYVsxXTtcclxuICAgICAgICAgICAgY29uc3QgY3VyQiA9IGJbMV07XHJcbiAgICAgICAgICAgIGlmKGlzTWF4KSBcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1ckJbdml0YWxIZWFkZXJdIC0gY3VyQVt2aXRhbEhlYWRlcl07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGN1ckFbdml0YWxIZWFkZXJdIC0gY3VyQlt2aXRhbEhlYWRlcl07XHJcbiAgICAgICAgfSlbMF07XHJcbiAgICAgICAgZmluYWxBcnJheVt2aXRhbEhlYWRlcl0gPSBzb3J0ZWRNYXhbMV1bdml0YWxIZWFkZXJdO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIFtmaW5hbEFycmF5LCBpc01heCA/IFwiTWF4aW11bVwiIDogXCJNaW5pbXVtXCJdO1xyXG59XHJcblxyXG5jb25zdCBjYWxjdWxhdGVTdGF0cyA9ICh0eXBlLCBkYXRhLCB2aXRhbEhlYWRlcnMpID0+IHtcclxuICAgIGxldCBjYWxjdWxhdGlvbnM7XHJcbiAgICBjb25zdCBzbGljZURhdGEgPSBkYXRhLnNsaWNlKDAsIDMwKTsgLy8gMzAgZmlyc3QgZGF0YSBwb2ludHMgPSA1IG1pbnV0ZXNcclxuICAgIHN3aXRjaCh0eXBlKXtcclxuICAgICAgICBjYXNlIFwibWVhblwiOlxyXG4gICAgICAgICAgICBjYWxjdWxhdGlvbnMgPSBjYWxjdWxhdGVNZWFuKHNsaWNlRGF0YSwgdml0YWxIZWFkZXJzKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcIm1heFwiOlxyXG4gICAgICAgICAgICBjYWxjdWxhdGlvbnMgPSBjYWxjdWxhdGVNYXhNaW4odHJ1ZSwgc2xpY2VEYXRhLCB2aXRhbEhlYWRlcnMpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwibWluXCI6XHJcbiAgICAgICAgICAgIGNhbGN1bGF0aW9ucyA9IGNhbGN1bGF0ZU1heE1pbihmYWxzZSwgc2xpY2VEYXRhLCB2aXRhbEhlYWRlcnMpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICAgIDx0ciBjbGFzc05hbWU9XCJ2aXRhbHJvd1wiPlxyXG4gICAgICAgICAgICA8dGQ+e2NhbGN1bGF0aW9uc1sxXX08L3RkPlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBPYmplY3QudmFsdWVzKGNhbGN1bGF0aW9uc1swXSkubWFwKCh2YWx1ZSxpZHgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8dGQga2V5PXtpZHh9Pnt2YWx1ZX08L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICA8L3RyPlxyXG4gICAgKVxyXG59XHJcblxyXG5jb25zdCBNb2RhbFZpZXdQYXRpZW50ID0gKHsgaXNPcGVuZWQsIGhpZGUsIHBhdGllbnQsIHZpdGFscywgYWN0aW9uIH0pID0+IGlzT3BlbmVkID8gUmVhY3RET00uY3JlYXRlUG9ydGFsKFxyXG5cclxuICAgIDxSZWFjdC5GcmFnbWVudD5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLW92ZXJsYXlcIi8+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbC13cmFwcGVyXCIgYXJpYS1tb2RhbCBhcmlhLWhpZGRlbiB0YWJJbmRleD17LTF9IHJvbGU9XCJkaWFsb2dcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbFwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ4LWhvbGRlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxpbWcgb25DbGljaz17aGlkZX0gXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYz1cImFzc2V0cy9pbWcveC5wbmdcIlxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtaGVhZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGgyPlZpc3VhbGlzZXIgdW4gcGF0aWVudDwvaDI+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHBhdGllbnQgPyBcclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLWJvZHlcIj4gICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLXVuaXQgaW5saW5lXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD57cGF0aWVudC5maXJzdE5hbWV9Jm5ic3A7PC9wPjxwPjxiPntwYXRpZW50Lm5hbWV9PC9iPjwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtdW5pdCBpbmxpbmVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwPntwYXRpZW50LmFnZX0gYW5zJm5ic3A7JiM4MjI2OyZuYnNwOzwvcD48cD57Zm9ybWF0U2V4KHBhdGllbnQuc2V4KX08L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLXVuaXQgaW5saW5lXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cD57cGF0aWVudC5lbWFpbH08L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDogXHJcbiAgICAgICAgICAgICAgICAgICAgbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YWJsZS1ob2xkZXJcIj4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aWVudCAmJiB2aXRhbHM/XHJcbiAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzTmFtZT1cInZpdGFscy10YWJsZVwiIGNlbGxTcGFjaW5nPVwiMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQgY2xhc3NOYW1lPVwidml0YWxoZWFkZXJyb3dcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+PC90aD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpdGFscy5oZWFkZXJzLm1hcCgodml0YWxIZWFkZXIsIGNvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBrZXk9e2NvdW50fT57cGFyc2UoZm9ybWF0SGVhZGVycyh2aXRhbEhlYWRlcikpfTwvdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+PGgzPlN0YXRpc3RpcXVlcyAoNSBkZXJuacOocmVzIG1pbnV0ZXMpPC9oMz48L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdml0YWxzLmhlYWRlcnMubWFwKCh2aXRhbEhlYWRlciwgY291bnQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGtleT17Y291bnR9PiZuYnNwOzwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVTdGF0cyhcIm1lYW5cIixPYmplY3QuZW50cmllcyh2aXRhbHMubWVhc3VyZW1lbnRzKS5yZXZlcnNlKCksIHZpdGFscy5oZWFkZXJzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZVN0YXRzKFwibWF4XCIsIE9iamVjdC5lbnRyaWVzKHZpdGFscy5tZWFzdXJlbWVudHMpLnJldmVyc2UoKSwgdml0YWxzLmhlYWRlcnMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlU3RhdHMoXCJtaW5cIiwgT2JqZWN0LmVudHJpZXModml0YWxzLm1lYXN1cmVtZW50cykucmV2ZXJzZSgpLCB2aXRhbHMuaGVhZGVycylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+PGgzPkRvbm7DqWVzPC9oMz48L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdml0YWxzLmhlYWRlcnMubWFwKCh2aXRhbEhlYWRlciwgY291bnQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGtleT17Y291bnR9PiZuYnNwOzwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC90aGVhZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5IGNsYXNzTmFtZT1cImRhdGEtaG9sZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZW50cmllcyh2aXRhbHMubWVhc3VyZW1lbnRzKS5yZXZlcnNlKCkubWFwKChtZWFzdXJlbWVudCxjb3VudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzTmFtZT1cInZpdGFscm93XCIga2V5PXtjb3VudH0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPnttZWFzdXJlbWVudFswXX08L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMobWVhc3VyZW1lbnRbMV0pLm1hcCgobWVhc3VyZW1lbnRWYWx1ZSwgaWR4KSA9PntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQga2V5PXtpZHh9PnttZWFzdXJlbWVudFZhbHVlWzFdfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cclxuICAgICAgICAgICAgICAgICAgICA6XHJcbiAgICAgICAgICAgICAgICAgICAgbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgPC9SZWFjdC5GcmFnbWVudD4sIGRvY3VtZW50LmJvZHlcclxuKVxyXG46XHJcbm51bGw7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBNb2RhbFZpZXdQYXRpZW50OyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBwYXJzZSBmcm9tIFwiaHRtbC1yZWFjdC1wYXJzZXJcIjtcclxuaW1wb3J0IHsgZm9ybWF0SGVhZGVycyB9IGZyb20gJy4uL3V0aWxpdGllcyc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gUGF0aWVudEVudHJ5IChwcm9wcykge1xyXG5cclxuICAgIGNvbnN0IHBhdGllbnRJbmZvID0ge1xyXG4gICAgICAgIG5hbWU6IHByb3BzLnBhdGllbnREYXRhLm5hbWUsXHJcbiAgICAgICAgZmlyc3ROYW1lOiBwcm9wcy5wYXRpZW50RGF0YS5maXJzdE5hbWUsXHJcbiAgICAgICAgYWdlOiBwcm9wcy5wYXRpZW50RGF0YS5hZ2UsXHJcbiAgICAgICAgc2V4OiBwcm9wcy5wYXRpZW50RGF0YS5zZXgsXHJcbiAgICAgICAgY29udGFjdDogcHJvcHMucGF0aWVudERhdGEuZW1haWwsXHJcbiAgICAgICAgcGF0aWVudElEOiBwcm9wcy5wYXRpZW50RGF0YS5wYXRpZW50SUQsXHJcbiAgICAgICAgdml0YWxzOiBwcm9wcy5wYXRpZW50RGF0YS5jdXJWaXRhbHNcclxuICAgIH1cclxuXHJcbiAgICAvLyBOb3RlOiBtb3N0IHBhdGllbnRzIHdpbGwgaGF2ZSB0aGUgc2FtZSB0eXBlcyBvZiB2aXRhbCBzaWducywgYnV0IHNvbWUgY291bGQgaGF2ZSBcclxuICAgIC8vIHNsaWdodGx5IGRpZmZlcmVudCBhbmQgbW9yZSBhZHZhbmNlZCBmZWF0dXJlcyB0byBkaXNwbGF5LiBJdCB3b3VsZCBiZSBuaWNlIHRvIG1ha2VcclxuICAgIC8vIHRoaXMgdGFibGUgZnVsbHkgY29tcGF0aWJsZSB3aXRoIGFsbCBkYXRhIHR5cGVzLCB3aXRob3V0IG1ha2luZyB0aGUgVUkgdG9vXHJcbiAgICAvLyBjb21wbGljYXRlZCBvciBjcm93ZGVkLlxyXG5cclxuICAgIHJldHVybiAoXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYXRpZW50RW50cnlcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2RpdmlzaW9uIG5hbWVzJz5cclxuICAgICAgICAgICAgICAgIDxoND57cGF0aWVudEluZm8ubmFtZX08L2g0PlxyXG4gICAgICAgICAgICAgICAgPHA+e3BhdGllbnRJbmZvLmZpcnN0TmFtZX08L3A+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZGl2aXNpb24gYWdlJz5cclxuICAgICAgICAgICAgICAgIDxoNT57cGF0aWVudEluZm8uYWdlfSBhbnM8L2g1PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2RpdmlzaW9uIHNleCc+XHJcbiAgICAgICAgICAgICAgICA8aDU+e3BhdGllbnRJbmZvLnNleH08L2g1PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2RpdmlzaW9uIGNvbnRhY3QnPlxyXG4gICAgICAgICAgICAgICAgPGg1PjxhIGhyZWY9e2BtYWlsdG86JHtwYXRpZW50SW5mby5jb250YWN0fWB9PkNvbnRhY3Q8L2E+PC9oNT5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdkaXZpc2lvbiB2aXRhbHMnPlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHBhdGllbnRJbmZvLnZpdGFscykubWFwKChlbGVtLGNvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e2NvdW50fSBjbGFzc05hbWU9J3ZpdGFsVW5pdCc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSd0eXBlJz57cGFyc2UoZm9ybWF0SGVhZGVycyhlbGVtWzBdKSl9PC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNSBjbGFzc05hbWU9J3ZhbHVlJz57ZWxlbVsxXX08L2g1PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2RpdmlzaW9uIGV5ZScgb25DbGljaz17ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHMuc2hvd1BhdGllbnQocGF0aWVudEluZm8ucGF0aWVudElEKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0+XHJcbiAgICAgICAgICAgICAgICA8aW1nIFxyXG4gICAgICAgICAgICAgICAgICAgIHNyYz0nYXNzZXRzL2ltZy9leWUucG5nJ1xyXG4gICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdkaXZpc2lvbiBkZWxldGUnIG9uQ2xpY2s9eygpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHMuZGVsZXRlUGF0aWVudChwYXRpZW50SW5mby5wYXRpZW50SUQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0+XHJcbiAgICAgICAgICAgICAgICA8aW1nIFxyXG4gICAgICAgICAgICAgICAgICAgIHNyYz0nYXNzZXRzL2ltZy9iaW4ucG5nJ1xyXG4gICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICApXHJcbn0iLCJpbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XHJcblxyXG5jb25zdCBVUkwgPSBcImh0dHBzOi8vY2xlaW8tc2VydmVyLmhlcm9rdWFwcC5jb20vYXBpXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2VuZEdldFJlcXVlc3Qocm91dGUsIHBhcmFtcyl7XHJcblxyXG4gICAgY29uc3QgY3VyUGFyYW1zID0ge1xyXG4gICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBmZXRjaChgJHtVUkx9JHtyb3V0ZX1gLCBjdXJQYXJhbXMpXHJcbiAgICAgICAgLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNwLmpzb24oKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBzZW5kaW5nIEdldCByZXF1ZXN0OiAnLCBlKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNlbmRQb3N0UmVxdWVzdChyb3V0ZSxwYXJhbXMsYm9keSl7XHJcbiAgICBjb25zdCBjdXJQYXJhbXMgPSB7XHJcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBmZXRjaChgJHtVUkx9JHtyb3V0ZX1gLCBjdXJQYXJhbXMpXHJcbiAgICAgICAgLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNwLmpzb24oKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBzZW5kaW5nIFBvc3QgcmVxdWVzdDonLGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9KVxyXG59IiwiaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IHVzZU1vZGFsIGZyb20gXCIuL3VzZU1vZGFsXCI7XHJcbmltcG9ydCB7IHVzZUludGVydmFsIH0gZnJvbSBcIi4vdXNlSW50ZXJ2YWxcIjtcclxuaW1wb3J0IE1vZGFsQWRkUGF0aWVudCBmcm9tIFwiLi9Nb2RhbEFkZFBhdGllbnRcIjtcclxuaW1wb3J0IE1vZGFsVmlld1BhdGllbnQgZnJvbSBcIi4vTW9kYWxWaWV3UGF0aWVudFwiO1xyXG5pbXBvcnQgeyBQYXRpZW50RW50cnkgfSBmcm9tIFwiLi9QYXRpZW50RW50cnlcIjtcclxuaW1wb3J0IHsgc2VuZEdldFJlcXVlc3QsIHNlbmRQb3N0UmVxdWVzdCB9IGZyb20gXCIuLi9yZXF1ZXN0ZXJcIjtcclxuaW1wb3J0IHsgcm91dGVzIH0gZnJvbSBcIi4uL3V0aWxpdGllc1wiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIERhc2hib2FyZChwcm9wcyl7XHJcblxyXG4gICAgY29uc3QgW2xpc3RlZFBhdGllbnRzLCBzZXRMaXN0ZWRQYXRpZW50c10gPSB1c2VTdGF0ZShudWxsKTtcclxuICAgIGNvbnN0IFtuZXdQYXRpZW50T3BlbmVkLCBzZXRNb2RhbE5ld1BhdGllbnRdID0gdXNlTW9kYWwoKTtcclxuICAgIGNvbnN0IFt2aWV3UGF0aWVudE9wZW5lZCwgc2V0TW9kYWxWaWV3UGF0aWVudF0gPSB1c2VNb2RhbCgpO1xyXG4gICAgY29uc3QgW3ZpZXdQYXRpZW50T2JqLCBzZXRWaWV3UGF0aWVudE9ial0gPSB1c2VTdGF0ZShudWxsKTtcclxuICAgIGNvbnN0IFt2aWV3UGF0aWVudFZpdGFscywgc2V0Vmlld1BhdGllbnRWaXRhbHNdID0gdXNlU3RhdGUobnVsbCk7XHJcblxyXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgICAgICB1cGRhdGVQYXRpZW50TGlzdCgpO1xyXG4gICAgfSwgW10pO1xyXG5cclxuICAgIHVzZUludGVydmFsKCgpID0+IHtcclxuICAgICAgICB1cGRhdGVQYXRpZW50TGlzdCgpO1xyXG4gICAgICAgIGlmKHZpZXdQYXRpZW50T2JqKXtcclxuICAgICAgICAgICAgdXBkYXRlVmlld2VkUGF0aWVudFZpdGFscyh2aWV3UGF0aWVudE9iai5wYXRpZW50SUQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sIDEwMDAwKVxyXG5cclxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICAgXHJcbiAgICB9LCBbdmlld1BhdGllbnRPYmpdKVxyXG5cclxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICB9LCBbdmlld1BhdGllbnRWaXRhbHNdKVxyXG5cclxuICAgIGNvbnN0IHVwZGF0ZVBhdGllbnRMaXN0ID0gKCkgPT4ge1xyXG4gICAgICAgIHNlbmRHZXRSZXF1ZXN0KHJvdXRlcy5nZXRBbGxQYXRpZW50cylcclxuICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBzZXRMaXN0ZWRQYXRpZW50cyhyZXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdXBkYXRlVmlld2VkUGF0aWVudFZpdGFscyA9IChpZCkgPT4ge1xyXG4gICAgICAgIHNlbmRHZXRSZXF1ZXN0KGAke3JvdXRlcy5nZXRWaXRhbHNmb3JQYXRpZW50fSR7aWR9YCwgbnVsbClcclxuICAgICAgICAudGhlbihyZSA9PiB7XHJcbiAgICAgICAgICAgIGlmKHJlLnJlc3VsdHMpe1xyXG4gICAgICAgICAgICAgICAgc2V0Vmlld1BhdGllbnRWaXRhbHMocmUucmVzdWx0cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGFkZFBhdGllbnQgPSAob2JqKSA9PiB7XHJcbiAgICAgICAgc2VuZFBvc3RSZXF1ZXN0KHJvdXRlcy5wb3N0U2luZ2xlUGF0aWVudCwgbnVsbCwgb2JqKVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIHVwZGF0ZVBhdGllbnRMaXN0KCk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBkZWxldGVQYXRpZW50ID0gKGlkKSA9PiB7XHJcbiAgICAgICAgc2VuZFBvc3RSZXF1ZXN0KGAke3JvdXRlcy5kZWxldGVTaW5nbGVQYXRpZW50fSR7aWR9YCwgbnVsbCwge30pXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVQYXRpZW50TGlzdCgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHNob3dQYXRpZW50ID0gKGlkKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcGF0aWVudElEID0gcGFyc2VJbnQoaWQpO1xyXG4gICAgICAgIHNldE1vZGFsVmlld1BhdGllbnQodHJ1ZSk7XHJcbiAgICAgICAgc2VuZEdldFJlcXVlc3QoYCR7cm91dGVzLmdldFNpbmdsZVBhdGllbnR9JHtwYXRpZW50SUR9YCwgbnVsbClcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGlmKHJlcy5yZXN1bHRzKXtcclxuICAgICAgICAgICAgICAgICAgICBzZXRWaWV3UGF0aWVudE9iaihyZXMucmVzdWx0cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVmlld2VkUGF0aWVudFZpdGFscyhwYXRpZW50SUQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWFpbmZyYW1lXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhZGVyXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxhYmVsSG9sZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGgyPlRhYmxlYXUgZGUgYm9yZDwvaDI+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uSG9sZGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXtzZXRNb2RhbE5ld1BhdGllbnR9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8cD5Bam91dGVyPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhdGllbnRMaXN0XCI+XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVkUGF0aWVudHMgPyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGVkUGF0aWVudHMubWFwKChlbGVtLGNvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gPFBhdGllbnRFbnRyeSBrZXk9e2NvdW50fSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aWVudERhdGE9e2VsZW19IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVQYXRpZW50PXtkZWxldGVQYXRpZW50fSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1BhdGllbnQ9e3Nob3dQYXRpZW50fS8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaW5rLWhvbGRlclwiPlxyXG4gICAgICAgICAgICAgICAgPHA+PGEgaHJlZj1cImh0dHBzOi8vZG9jcy5nb29nbGUuY29tL3ByZXNlbnRhdGlvbi9kLzFZdXZydjZWbk40MTNtOEtudEpjZlc2MFV3NVdRZDdCNVhKeWpiaWFES19ZL2VkaXQ/dXNwPXNoYXJpbmdcIj5MaW5rIHRvIHByZXNlbnRhdGlvbjwvYT48L3A+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8TW9kYWxBZGRQYXRpZW50IFxyXG4gICAgICAgICAgICAgICAgaXNPcGVuZWQ9e25ld1BhdGllbnRPcGVuZWR9XHJcbiAgICAgICAgICAgICAgICBoaWRlPXtzZXRNb2RhbE5ld1BhdGllbnR9XHJcbiAgICAgICAgICAgICAgICBhY3Rpb249e2FkZFBhdGllbnR9XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgIDxNb2RhbFZpZXdQYXRpZW50IFxyXG4gICAgICAgICAgICAgICAgaXNPcGVuZWQ9e3ZpZXdQYXRpZW50T3BlbmVkfVxyXG4gICAgICAgICAgICAgICAgaGlkZT17KCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldE1vZGFsVmlld1BhdGllbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXRWaWV3UGF0aWVudE9iaihudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXRWaWV3UGF0aWVudFZpdGFscyhudWxsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHBhdGllbnQ9e3ZpZXdQYXRpZW50T2JqfVxyXG4gICAgICAgICAgICAgICAgdml0YWxzPXt2aWV3UGF0aWVudFZpdGFsc31cclxuICAgICAgICAgICAgICAgIGFjdGlvbj17KCkgPT4ge2NvbnNvbGUubG9nKCdub3QgaW1wbGVtZW50ZWQuJyl9fVxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgKVxyXG5cclxufSIsImltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tIFwicmVhY3RcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1c2VJbnRlcnZhbChjYWxsYmFjaywgZGVsYXkpe1xyXG5cclxuICAgIGNvbnN0IHNhdmVkQ0IgPSB1c2VSZWYoKTtcclxuXHJcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgICAgIHNhdmVkQ0IuY3VycmVudCA9IGNhbGxiYWNrO1xyXG4gICAgfSwgW2NhbGxiYWNrXSk7XHJcblxyXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgICAgICBmdW5jdGlvbiB0aWNrKCl7XHJcbiAgICAgICAgICAgIHNhdmVkQ0IuY3VycmVudCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihkZWxheSAhPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIGxldCBpZCA9IHNldEludGVydmFsKHRpY2ssIGRlbGF5KTtcclxuICAgICAgICAgICAgcmV0dXJuICgpID0+IGNsZWFySW50ZXJ2YWwoaWQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sIFtkZWxheV0pO1xyXG5cclxufSIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmltcG9ydCAnLi4vYXNzZXRzL3N0eWxlcy9zdHlsZS5zY3NzJztcclxuaW1wb3J0ICogYXMgZDMgZnJvbSAnZDMnO1xyXG5pbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBSZWFjdERPTSBmcm9tIFwicmVhY3QtZG9tL2NsaWVudFwiO1xyXG5pbXBvcnQgeyBEYXNoYm9hcmQgfSBmcm9tICcuL2NvbXBvbmVudHMvRGFzaGJvYXJkJztcclxuXHJcbmNvbnN0IHJvb3QgPSBSZWFjdERPTS5jcmVhdGVSb290KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicm9vdFwiKSk7XHJcbnJvb3QucmVuZGVyKFxyXG4gICAgPERhc2hib2FyZCAvPlxyXG4pXHJcblxyXG4iXSwibmFtZXMiOlsidXNlTW9kYWwiLCJpc09wZW5lZCIsInNldE9wZW5lZCIsInVzZVN0YXRlIiwic2V4T3B0aW9ucyIsImxhYmVsIiwiZm9ybWF0SGVhZGVycyIsInZhbHVlIiwiZW1haWxSZWdleCIsIm9uU2VsZWN0U2V4IiwiZSIsImQzIiwiY2xhc3NlZCIsInRhcmdldCIsImdldFNlbGVjdGVkU2V4Iiwic2VsZWN0ZWRCdG4iLCJub2RlIiwiaW5uZXJUZXh0IiwidmVyaWZ5SW5wdXQiLCJjdXJUYXJnZXQiLCJjdXJWYWx1ZSIsInZlcmlmaWVkU3RhdGUiLCJpZCIsIlN0cmluZyIsImxlbmd0aCIsIm51bSIsInBhcnNlSW50IiwiaXNOYU4iLCJ0ZXN0IiwicmVzZXRJbnB1dERlY29yYXRpb24iLCJ2ZXJpZnlBbGxJbnB1dHMiLCJzZWxlY3Rpb24iLCJub2RlcyIsInZlcmlmaWVkT2JqIiwibWFwIiwiY3VyQ2hlY2tlZElucHV0IiwiYnBtIiwic2tpbnRlbXAiLCJzcG8yIiwiX3JlZiIsImhpZGUiLCJhY3Rpb24iLCJSZWFjdERPTSIsIlJlYWN0IiwiY2xhc3NOYW1lIiwidGFiSW5kZXgiLCJyb2xlIiwib25CbHVyIiwib25JbnB1dCIsIm9wdGlvbiIsImNvdW50Iiwia2V5Iiwib25DbGljayIsImRvY3VtZW50IiwiYm9keSIsImNhbGN1bGF0ZU1heE1pbiIsImlzTWF4IiwiZGF0YSIsInZpdGFsSGVhZGVycyIsImZpbmFsQXJyYXkiLCJmb3JFYWNoIiwidml0YWxIZWFkZXIiLCJzb3J0ZWRNYXgiLCJBcnJheSIsImZyb20iLCJzb3J0IiwiYSIsImIiLCJjdXJBIiwiY3VyQiIsImNhbGN1bGF0ZVN0YXRzIiwidHlwZSIsImNhbGN1bGF0aW9ucyIsInNsaWNlRGF0YSIsInNsaWNlIiwiY2FsY3VsYXRlTWVhbiIsInN1bW1lZERhdGEiLCJzdW1tZWRWYWx1ZSIsInJlZHVjZSIsImFjYyIsImN1clZhbCIsInBhcnNlRmxvYXQiLCJ0b0ZpeGVkIiwiT2JqZWN0IiwidmFsdWVzIiwiaWR4IiwicGF0aWVudCIsInZpdGFscyIsInNyYyIsImZpcnN0TmFtZSIsIm5hbWUiLCJhZ2UiLCJzZXgiLCJmb3JtYXRTZXgiLCJlbWFpbCIsImNlbGxTcGFjaW5nIiwiaGVhZGVycyIsInBhcnNlIiwiZW50cmllcyIsIm1lYXN1cmVtZW50cyIsInJldmVyc2UiLCJtZWFzdXJlbWVudCIsIm1lYXN1cmVtZW50VmFsdWUiLCJQYXRpZW50RW50cnkiLCJwcm9wcyIsInBhdGllbnRJbmZvIiwicGF0aWVudERhdGEiLCJjb250YWN0IiwicGF0aWVudElEIiwiY3VyVml0YWxzIiwiaHJlZiIsImVsZW0iLCJzaG93UGF0aWVudCIsImRlbGV0ZVBhdGllbnQiLCJVUkwiLCJzZW5kR2V0UmVxdWVzdCIsInJvdXRlIiwicGFyYW1zIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwicmVzcCIsImpzb24iLCJyZXN1bHQiLCJjYXRjaCIsImNvbnNvbGUiLCJsb2ciLCJzZW5kUG9zdFJlcXVlc3QiLCJjdXJQYXJhbXMiLCJKU09OIiwic3RyaW5naWZ5IiwiRGFzaGJvYXJkIiwibGlzdGVkUGF0aWVudHMiLCJzZXRMaXN0ZWRQYXRpZW50cyIsIm5ld1BhdGllbnRPcGVuZWQiLCJzZXRNb2RhbE5ld1BhdGllbnQiLCJ2aWV3UGF0aWVudE9wZW5lZCIsInNldE1vZGFsVmlld1BhdGllbnQiLCJ2aWV3UGF0aWVudE9iaiIsInNldFZpZXdQYXRpZW50T2JqIiwidmlld1BhdGllbnRWaXRhbHMiLCJzZXRWaWV3UGF0aWVudFZpdGFscyIsInVzZUVmZmVjdCIsInVwZGF0ZVBhdGllbnRMaXN0IiwiY2FsbGJhY2siLCJkZWxheSIsInNhdmVkQ0IiLCJ1c2VSZWYiLCJjdXJyZW50Iiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwidXNlSW50ZXJ2YWwiLCJ1cGRhdGVWaWV3ZWRQYXRpZW50Vml0YWxzIiwicmVzIiwicmUiLCJyZXN1bHRzIiwiTW9kYWxBZGRQYXRpZW50Iiwib2JqIiwiTW9kYWxWaWV3UGF0aWVudCIsImdldEVsZW1lbnRCeUlkIiwicmVuZGVyIl0sInNvdXJjZVJvb3QiOiIifQ==